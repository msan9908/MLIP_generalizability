Found box in energy kwargs
Remove replicated senders in neighbor list
vectors /= r_cutoff Works
receivers Works
net Works
Use a custom scatter implementation
Out irreps 192x0e+256x1o+64x1e
Irreps after layer are 64x1e+64x1o
Use a custom scatter implementation
Out irreps 64x0e+192x1o+192x1e
Irreps after layer are 64x1e+64x1o
Learn radius
Replicate outputs in charge_qeq_fn
Total charge specified: Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=9/1)>
Apply shielding
Add core interaction
Apply shielding
Total charge specified: Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=9/1)>
Apply shielding
pot  work
Use a custom scatter implementation
Out irreps 64x0e
Irreps after layer are Irreps()
features, qeq_features  work
Replicate potential outputs
features, qeq_features  work
charges, elec_pot   work Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=9/1)>
[Potential] Found precomputed forces.
Read out charge from aux.
Found box in energy kwargs
[Potential] Found precomputed forces.
Read out charge from aux.
[Epoch 0]:
	Average train loss: 63.86534
	Average val loss: 32.409156799316406
	Gradient norm: 81046.1171875
	Elapsed time = 6.206 min
	Per-target losses:
		U | train loss: 3540619.58718423 | val loss: 3454552.0
		charge | train loss: 0.6386534432527908 | val loss: 0.3240915536880493

[Epoch 1]:
	Average train loss: 17.33707
	Average val loss: 15.378474235534668
	Gradient norm: 2241.774169921875
	Elapsed time = 5.681 min
	Per-target losses:
		U | train loss: 3379758.1423290344 | val loss: 3501683.25
		charge | train loss: 0.17337072494715705 | val loss: 0.15378475189208984

[Epoch 2]:
	Average train loss: 11.95747
	Average val loss: 11.909210205078125
	Gradient norm: 611.8576049804688
	Elapsed time = 5.673 min
	Per-target losses:
		U | train loss: 3476476.0447187703 | val loss: 3696551.75
		charge | train loss: 0.11957469972141667 | val loss: 0.11909209191799164

[Epoch 3]:
	Average train loss: 9.15861
	Average val loss: 11.176712036132812
	Gradient norm: 5677.2255859375
	Elapsed time = 5.656 min
	Per-target losses:
		U | train loss: 3544039.7848854437 | val loss: 3675109.75
		charge | train loss: 0.09158609087772039 | val loss: 0.11176711320877075

[Epoch 4]:
	Average train loss: 7.63916
	Average val loss: 9.765993118286133
	Gradient norm: 800.0736083984375
	Elapsed time = 5.730 min
	Per-target losses:
		U | train loss: 3635885.541824211 | val loss: 3857846.25
		charge | train loss: 0.07639158656485646 | val loss: 0.09765993058681488

[Epoch 5]:
	Average train loss: 6.76883
	Average val loss: 9.048001289367676
	Gradient norm: 271.2761535644531
	Elapsed time = 5.640 min
	Per-target losses:
		U | train loss: 3691625.890006745 | val loss: 3863467.0
		charge | train loss: 0.0676882673795606 | val loss: 0.0904800146818161

[Epoch 6]:
	Average train loss: 6.35802
	Average val loss: 8.906880378723145
	Gradient norm: 350.21929931640625
	Elapsed time = 5.643 min
	Per-target losses:
		U | train loss: 3737239.5240813033 | val loss: 3892738.5
		charge | train loss: 0.06358017081223023 | val loss: 0.08906880766153336

