Found box in energy kwargs
Remove replicated senders in neighbor list
vectors /= r_cutoff Works
receivers Works
net Works
Use a custom scatter implementation
Out irreps 192x0e+256x1o+64x1e
Irreps after layer are 64x1e+64x1o
Use a custom scatter implementation
Out irreps 64x0e+192x1o+192x1e
Irreps after layer are 64x1e+64x1o
Learn radius
Replicate outputs in charge_qeq_fn
Total charge specified: Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=9/1)>
Apply shielding
Add core interaction
Apply shielding
Total charge specified: Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=9/1)>
Apply shielding
pot  work
Use a custom scatter implementation
Out irreps 64x0e
Irreps after layer are Irreps()
features, qeq_features  work
Replicate potential outputs
features, qeq_features  work
charges, elec_pot   work Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=9/1)>
[Potential] Found precomputed forces.
Read out charge from aux.
Found box in energy kwargs
[Potential] Found precomputed forces.
Read out charge from aux.
[Epoch 0]:
	Average train loss: 75.47475
	Average val loss: 22.495235443115234
	Gradient norm: 16733.84375
	Elapsed time = 5.893 min
	Per-target losses:
		U | train loss: 3423773.844746225 | val loss: 2930487.75
		charge | train loss: 0.7547474873695997 | val loss: 0.22495236992835999

[Epoch 1]:
	Average train loss: 19.15265
	Average val loss: 14.865700721740723
	Gradient norm: 3571.408203125
	Elapsed time = 5.365 min
	Per-target losses:
		U | train loss: 3021922.8851510067 | val loss: 3189880.75
		charge | train loss: 0.19152646995080796 | val loss: 0.14865700900554657

[Epoch 2]:
	Average train loss: 12.57737
	Average val loss: 11.334952354431152
	Gradient norm: 8907.396484375
	Elapsed time = 5.337 min
	Per-target losses:
		U | train loss: 3203661.2524643457 | val loss: 3046660.25
		charge | train loss: 0.1257737327617087 | val loss: 0.11334952712059021

[Epoch 3]:
	Average train loss: 9.63682
	Average val loss: 9.377019882202148
	Gradient norm: 1914.2457275390625
	Elapsed time = 5.144 min
	Per-target losses:
		U | train loss: 3343306.598990667 | val loss: 3164984.25
		charge | train loss: 0.09636821381797726 | val loss: 0.09377019852399826

[Epoch 4]:
	Average train loss: 7.97679
	Average val loss: 8.262121200561523
	Gradient norm: 1385.9483642578125
	Elapsed time = 5.367 min
	Per-target losses:
		U | train loss: 3374643.755778104 | val loss: 3173077.5
		charge | train loss: 0.07976788707927569 | val loss: 0.08262121677398682

[Epoch 5]:
	Average train loss: 7.06632
	Average val loss: 7.674860000610352
	Gradient norm: 1755.384033203125
	Elapsed time = 5.368 min
	Per-target losses:
		U | train loss: 3374629.290740352 | val loss: 3178896.5
		charge | train loss: 0.07066317237788598 | val loss: 0.07674860209226608

[Epoch 6]:
	Average train loss: 6.58984
	Average val loss: 7.285951614379883
	Gradient norm: 1087.0556640625
	Elapsed time = 5.387 min
	Per-target losses:
		U | train loss: 3381809.194699035 | val loss: 3227863.0
		charge | train loss: 0.06589838234870225 | val loss: 0.0728595182299614

