2025-11-17 15:07:17.761 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 15:07:17.761 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 15:07:17.761 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 15:07:17.761 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 15:07:17.761 INFO: MACE version: 0.3.14
2025-11-17 15:07:17.761 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f3f44cc40d0>, compute_atomic_dipole=<function str2bool at 0x7f3f44cc40d0>, train_file='../qmof_xyz/qmof_min_validation.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 15:07:17.867 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 15:07:17.922 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:07:17.927 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:07:17.929 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 15:07:17.929 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 15:07:17.931 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 15:07:17.931 INFO: ===========LOADING INPUT DATA===========
2025-11-17 15:07:17.931 INFO: Using heads: ['Default']
2025-11-17 15:07:17.931 INFO: Using the key specifications to parse data:
2025-11-17 15:07:17.931 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 15:07:17.931 INFO: =============    Processing head Default     ===========
2025-11-17 15:07:17.931 DEBUG: Loading training file: ../qmof_xyz/qmof_min_validation.extxyz
2025-11-17 15:07:19.662 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:07:19.964 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_validation.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:07:20.161 INFO: Training set 1/1 [energy: 1877, stress: 0, virials: 0, dipole components: 0, head: 1877, elec_temp: 0, total_charge: 1877, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:07:20.174 INFO: Total Training set [energy: 1877, stress: 0, virials: 0, dipole components: 0, head: 1877, elec_temp: 0, total_charge: 1877, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:07:20.174 INFO: No validation set provided, splitting training data instead.
2025-11-17 15:07:20.174 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 15:07:20.184 INFO: Random Split Training set [energy: 1690, stress: 0, virials: 0, dipole components: 0, head: 1690, elec_temp: 0, total_charge: 1690, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:07:20.186 INFO: Random Split Validation set [energy: 187, stress: 0, virials: 0, dipole components: 0, head: 187, elec_temp: 0, total_charge: 187, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:07:28.290 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:07:29.751 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:07:30.572 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:07:30.665 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:07:30.666 INFO: Total number of configurations: train=1690, valid=187, tests=[Default_Default: 8346],
2025-11-17 15:07:30.729 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 78, 79, 83, 92]
2025-11-17 15:07:30.729 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 15:07:30.729 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 15:07:30.887 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9594801591828723, 3: -5.380117396304216, 5: -9.76452607790715, 6: -8.911412205580575, 7: -7.949606249700137, 8: -6.745938343957359, 9: -4.132103286578206, 11: -5.06145700728271, 12: -7.524439922563262, 13: -8.323065697992584, 14: -5.2046842662974715, 15: -7.731327750289557, 16: -4.063403428147575, 17: -2.6205645701931495, 20: -9.767208193890186, 21: -14.541598135379383, 22: -14.674740407982032, 23: -13.182003929373264, 24: -10.945098235668157, 25: -11.88731695289167, 26: -9.917458263969838, 27: -8.205391797267474, 28: -6.856861872279164, 29: -4.523665108494172, 30: -3.512705246603547, 31: -2.306223393549203, 35: -1.9760486023662232, 38: -9.049745694496707, 39: -15.751651795796416, 40: -15.67275603548606, 42: -14.396235733543104, 44: -9.008488307575565, 46: -6.640792020510963, 47: -2.6226195589799772, 48: -3.3783822603679337, 53: -1.7046996646226509, 56: -8.574016550643512, 57: -13.783817560632565, 58: -15.881552849586258, 59: -14.193797557524807, 60: -14.618377211357561, 62: -14.18528262866024, 63: -16.255613994551336, 64: -13.858534642196084, 65: -14.171789306477432, 66: -13.998107074286086, 67: -13.951238165306801, 68: -14.019463141885511, 69: -13.885428414926528, 71: -15.076173927608322, 72: -16.49572010637724, 74: -15.62041481528414, 78: -6.917383003374346, 79: -3.4591828292191313, 83: -6.6071267607956585, 92: -19.40288463117869}
2025-11-17 15:07:30.887 INFO: Processing datasets for head 'Default'
2025-11-17 15:08:07.118 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_validation.extxyz']
2025-11-17 15:08:07.118 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 15:08:10.806 INFO: Head 'Default' training dataset size: 1690
2025-11-17 15:08:10.808 INFO: Computing average number of neighbors
2025-11-17 15:08:17.034 WARNING: Unusual average number of neighbors: 112.5
2025-11-17 15:08:17.034 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 15:08:17.034 INFO: ===========MODEL DETAILS===========
2025-11-17 15:08:46.334 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 15:08:46.345 INFO: Building model
2025-11-17 15:08:46.345 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 15:08:46.345 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 15:08:46.345 INFO: 8 radial and 5 basis functions
2025-11-17 15:08:46.345 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 15:08:46.345 INFO: Distance transform for radial basis functions: None
2025-11-17 15:08:46.345 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 15:08:48.169 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(56x0e -> 64x0e | 3584 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9595, -5.3801, -9.7645, -8.9114, -7.9496, -6.7459, -4.1321, -5.0615, -7.5244, -8.3231, -5.2047, -7.7313, -4.0634, -2.6206, -9.7672, -14.5416, -14.6747, -13.1820, -10.9451, -11.8873, -9.9175, -8.2054, -6.8569, -4.5237, -3.5127, -2.3062, -1.9760, -9.0497, -15.7517, -15.6728, -14.3962, -9.0085, -6.6408, -2.6226, -3.3784, -1.7047, -8.5740, -13.7838, -15.8816, -14.1938, -14.6184, -14.1853, -16.2556, -13.8585, -14.1718, -13.9981, -13.9512, -14.0195, -13.8854, -15.0762, -16.4957, -15.6204, -6.9174, -3.4592, -6.6071, -19.4029]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 56x0e -> 64x0e+64x1o+64x2e | 229376 paths | 229376 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 56x0e -> 64x0e | 229376 paths | 229376 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 56x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 56x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 15:08:48.171 INFO: Total number of parameters: 776352
2025-11-17 15:08:48.171 INFO: 
2025-11-17 15:08:48.171 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 15:08:48.171 INFO: Using ADAM as parameter optimizer
2025-11-17 15:08:48.171 INFO: Batch size: 2
2025-11-17 15:08:48.171 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 15:08:48.171 INFO: Number of gradient updates: 84500
2025-11-17 15:08:48.172 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 15:08:48.172 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 15:08:48.172 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 15:08:48.333 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 15:08:48.333 INFO: 
2025-11-17 15:08:48.333 INFO: ===========TRAINING===========
2025-11-17 15:08:48.333 INFO: Started training, reporting errors on validation set
2025-11-17 15:08:48.333 INFO: Loss metrics on validation set
2025-11-17 15:09:24.866 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 15:09:24.867 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 15:09:24.867 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o.
2025-11-17 15:09:24.867 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 15:09:24.867 INFO: MACE version: 0.3.14
2025-11-17 15:09:24.867 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o, edge_irreps=None, num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f0ba03c80d0>, compute_atomic_dipole=<function str2bool at 0x7f0ba03c80d0>, train_file='../qmof_xyz/qmof_min_validation.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 15:09:24.958 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 15:09:25.023 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:09:25.027 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:09:25.030 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 15:09:25.031 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 15:09:25.033 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 15:09:25.033 INFO: ===========LOADING INPUT DATA===========
2025-11-17 15:09:25.033 INFO: Using heads: ['Default']
2025-11-17 15:09:25.033 INFO: Using the key specifications to parse data:
2025-11-17 15:09:25.033 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 15:09:25.033 INFO: =============    Processing head Default     ===========
2025-11-17 15:09:25.033 DEBUG: Loading training file: ../qmof_xyz/qmof_min_validation.extxyz
2025-11-17 15:09:26.536 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:09:26.792 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_validation.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:09:26.958 INFO: Training set 1/1 [energy: 1877, stress: 0, virials: 0, dipole components: 0, head: 1877, elec_temp: 0, total_charge: 1877, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:09:26.967 INFO: Total Training set [energy: 1877, stress: 0, virials: 0, dipole components: 0, head: 1877, elec_temp: 0, total_charge: 1877, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:09:26.967 INFO: No validation set provided, splitting training data instead.
2025-11-17 15:09:26.967 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 15:09:26.976 INFO: Random Split Training set [energy: 1690, stress: 0, virials: 0, dipole components: 0, head: 1690, elec_temp: 0, total_charge: 1690, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:09:26.977 INFO: Random Split Validation set [energy: 187, stress: 0, virials: 0, dipole components: 0, head: 187, elec_temp: 0, total_charge: 187, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:09:33.314 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:09:34.467 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:09:35.150 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:09:35.198 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:09:35.198 INFO: Total number of configurations: train=1690, valid=187, tests=[Default_Default: 8346],
2025-11-17 15:09:35.254 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 78, 79, 83, 92]
2025-11-17 15:09:35.255 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 15:09:35.255 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 15:09:35.388 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9594801591828723, 3: -5.380117396304216, 5: -9.76452607790715, 6: -8.911412205580575, 7: -7.949606249700137, 8: -6.745938343957359, 9: -4.132103286578206, 11: -5.06145700728271, 12: -7.524439922563262, 13: -8.323065697992584, 14: -5.2046842662974715, 15: -7.731327750289557, 16: -4.063403428147575, 17: -2.6205645701931495, 20: -9.767208193890186, 21: -14.541598135379383, 22: -14.674740407982032, 23: -13.182003929373264, 24: -10.945098235668157, 25: -11.88731695289167, 26: -9.917458263969838, 27: -8.205391797267474, 28: -6.856861872279164, 29: -4.523665108494172, 30: -3.512705246603547, 31: -2.306223393549203, 35: -1.9760486023662232, 38: -9.049745694496707, 39: -15.751651795796416, 40: -15.67275603548606, 42: -14.396235733543104, 44: -9.008488307575565, 46: -6.640792020510963, 47: -2.6226195589799772, 48: -3.3783822603679337, 53: -1.7046996646226509, 56: -8.574016550643512, 57: -13.783817560632565, 58: -15.881552849586258, 59: -14.193797557524807, 60: -14.618377211357561, 62: -14.18528262866024, 63: -16.255613994551336, 64: -13.858534642196084, 65: -14.171789306477432, 66: -13.998107074286086, 67: -13.951238165306801, 68: -14.019463141885511, 69: -13.885428414926528, 71: -15.076173927608322, 72: -16.49572010637724, 74: -15.62041481528414, 78: -6.917383003374346, 79: -3.4591828292191313, 83: -6.6071267607956585, 92: -19.40288463117869}
2025-11-17 15:09:35.388 INFO: Processing datasets for head 'Default'
2025-11-17 15:10:08.500 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_validation.extxyz']
2025-11-17 15:10:08.501 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 15:10:12.075 INFO: Head 'Default' training dataset size: 1690
2025-11-17 15:10:12.076 INFO: Computing average number of neighbors
2025-11-17 15:10:18.184 WARNING: Unusual average number of neighbors: 112.5
2025-11-17 15:10:18.185 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 15:10:18.185 INFO: ===========MODEL DETAILS===========
2025-11-17 15:10:29.250 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 15:10:29.253 INFO: Building model
2025-11-17 15:10:29.253 INFO: Message passing with 64 channels and max_L=1 (64x0e+64x1o)
2025-11-17 15:10:29.253 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 15:10:29.253 INFO: 8 radial and 5 basis functions
2025-11-17 15:10:29.253 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 15:10:29.253 INFO: Distance transform for radial basis functions: None
2025-11-17 15:10:29.253 INFO: Hidden irreps: 64x0e+64x1o
2025-11-17 15:10:30.308 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(56x0e -> 64x0e | 3584 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9595, -5.3801, -9.7645, -8.9114, -7.9496, -6.7459, -4.1321, -5.0615, -7.5244, -8.3231, -5.2047, -7.7313, -4.0634, -2.6206, -9.7672, -14.5416, -14.6747, -13.1820, -10.9451, -11.8873, -9.9175, -8.2054, -6.8569, -4.5237, -3.5127, -2.3062, -1.9760, -9.0497, -15.7517, -15.6728, -14.3962, -9.0085, -6.6408, -2.6226, -3.3784, -1.7047, -8.5740, -13.7838, -15.8816, -14.1938, -14.6184, -14.1853, -16.2556, -13.8585, -14.1718, -13.9981, -13.9512, -14.0195, -13.8854, -15.0762, -16.4957, -15.6204, -6.9174, -3.4592, -6.6071, -19.4029]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 56x0e -> 64x0e+64x1o | 229376 paths | 229376 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(64x0e+64x0e+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 56x0e -> 64x0e | 229376 paths | 229376 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-1): 2 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 56x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 56x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 15:10:30.311 INFO: Total number of parameters: 682144
2025-11-17 15:10:30.311 INFO: 
2025-11-17 15:10:30.311 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 15:10:30.311 INFO: Using ADAM as parameter optimizer
2025-11-17 15:10:30.311 INFO: Batch size: 2
2025-11-17 15:10:30.311 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 15:10:30.311 INFO: Number of gradient updates: 84500
2025-11-17 15:10:30.311 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 15:10:30.311 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 15:10:30.312 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 15:10:30.419 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 15:10:30.419 INFO: 
2025-11-17 15:10:30.420 INFO: ===========TRAINING===========
2025-11-17 15:10:30.420 INFO: Started training, reporting errors on validation set
2025-11-17 15:10:30.420 INFO: Loss metrics on validation set
2025-11-17 15:10:47.313 INFO: Initial: head: Default, loss=0.00685172, MAE_E_per_atom=   61.93 meV, MAE_F=None meV / A
2025-11-17 15:15:25.329 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 15:15:25.329 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 15:15:25.329 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o.
2025-11-17 15:15:25.329 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 15:15:25.329 INFO: MACE version: 0.3.14
2025-11-17 15:15:25.329 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o, edge_irreps=None, num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f8203bc80d0>, compute_atomic_dipole=<function str2bool at 0x7f8203bc80d0>, train_file='../qmof_xyz/qmof_min_validation.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 15:15:25.412 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 15:15:25.438 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:15:25.440 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:15:25.441 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 15:15:25.441 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 15:15:25.443 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 15:15:25.443 INFO: ===========LOADING INPUT DATA===========
2025-11-17 15:15:25.443 INFO: Using heads: ['Default']
2025-11-17 15:15:25.443 INFO: Using the key specifications to parse data:
2025-11-17 15:15:25.443 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 15:15:25.443 INFO: =============    Processing head Default     ===========
2025-11-17 15:15:25.443 DEBUG: Loading training file: ../qmof_xyz/qmof_min_validation.extxyz
2025-11-17 15:15:26.827 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:15:27.098 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_validation.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:15:27.255 INFO: Training set 1/1 [energy: 1877, stress: 0, virials: 0, dipole components: 0, head: 1877, elec_temp: 0, total_charge: 1877, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:15:27.264 INFO: Total Training set [energy: 1877, stress: 0, virials: 0, dipole components: 0, head: 1877, elec_temp: 0, total_charge: 1877, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:15:27.264 INFO: No validation set provided, splitting training data instead.
2025-11-17 15:15:27.264 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 15:15:27.274 INFO: Random Split Training set [energy: 1690, stress: 0, virials: 0, dipole components: 0, head: 1690, elec_temp: 0, total_charge: 1690, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:15:27.275 INFO: Random Split Validation set [energy: 187, stress: 0, virials: 0, dipole components: 0, head: 187, elec_temp: 0, total_charge: 187, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:15:35.901 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:15:37.044 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:15:37.729 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:15:37.800 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:15:37.800 INFO: Total number of configurations: train=1690, valid=187, tests=[Default_Default: 8346],
2025-11-17 15:15:37.861 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 78, 79, 83, 92]
2025-11-17 15:15:37.861 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 15:15:37.861 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 15:15:38.000 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9594801591828723, 3: -5.380117396304216, 5: -9.76452607790715, 6: -8.911412205580575, 7: -7.949606249700137, 8: -6.745938343957359, 9: -4.132103286578206, 11: -5.06145700728271, 12: -7.524439922563262, 13: -8.323065697992584, 14: -5.2046842662974715, 15: -7.731327750289557, 16: -4.063403428147575, 17: -2.6205645701931495, 20: -9.767208193890186, 21: -14.541598135379383, 22: -14.674740407982032, 23: -13.182003929373264, 24: -10.945098235668157, 25: -11.88731695289167, 26: -9.917458263969838, 27: -8.205391797267474, 28: -6.856861872279164, 29: -4.523665108494172, 30: -3.512705246603547, 31: -2.306223393549203, 35: -1.9760486023662232, 38: -9.049745694496707, 39: -15.751651795796416, 40: -15.67275603548606, 42: -14.396235733543104, 44: -9.008488307575565, 46: -6.640792020510963, 47: -2.6226195589799772, 48: -3.3783822603679337, 53: -1.7046996646226509, 56: -8.574016550643512, 57: -13.783817560632565, 58: -15.881552849586258, 59: -14.193797557524807, 60: -14.618377211357561, 62: -14.18528262866024, 63: -16.255613994551336, 64: -13.858534642196084, 65: -14.171789306477432, 66: -13.998107074286086, 67: -13.951238165306801, 68: -14.019463141885511, 69: -13.885428414926528, 71: -15.076173927608322, 72: -16.49572010637724, 74: -15.62041481528414, 78: -6.917383003374346, 79: -3.4591828292191313, 83: -6.6071267607956585, 92: -19.40288463117869}
2025-11-17 15:15:38.000 INFO: Processing datasets for head 'Default'
2025-11-17 15:16:01.342 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_validation.extxyz']
2025-11-17 15:16:01.343 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 15:16:04.990 INFO: Head 'Default' training dataset size: 1690
2025-11-17 15:16:04.991 INFO: Computing average number of neighbors
2025-11-17 15:16:30.044 WARNING: Unusual average number of neighbors: 112.5
2025-11-17 15:16:30.045 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 15:16:30.045 INFO: ===========MODEL DETAILS===========
2025-11-17 15:16:48.895 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 15:16:48.904 INFO: Building model
2025-11-17 15:16:48.904 INFO: Message passing with 64 channels and max_L=1 (64x0e+64x1o)
2025-11-17 15:16:48.904 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 15:16:48.904 INFO: 8 radial and 5 basis functions
2025-11-17 15:16:48.904 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 15:16:48.904 INFO: Distance transform for radial basis functions: None
2025-11-17 15:16:48.904 INFO: Hidden irreps: 64x0e+64x1o
2025-11-17 15:16:50.500 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(56x0e -> 64x0e | 3584 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9595, -5.3801, -9.7645, -8.9114, -7.9496, -6.7459, -4.1321, -5.0615, -7.5244, -8.3231, -5.2047, -7.7313, -4.0634, -2.6206, -9.7672, -14.5416, -14.6747, -13.1820, -10.9451, -11.8873, -9.9175, -8.2054, -6.8569, -4.5237, -3.5127, -2.3062, -1.9760, -9.0497, -15.7517, -15.6728, -14.3962, -9.0085, -6.6408, -2.6226, -3.3784, -1.7047, -8.5740, -13.7838, -15.8816, -14.1938, -14.6184, -14.1853, -16.2556, -13.8585, -14.1718, -13.9981, -13.9512, -14.0195, -13.8854, -15.0762, -16.4957, -15.6204, -6.9174, -3.4592, -6.6071, -19.4029]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 56x0e -> 64x0e+64x1o | 229376 paths | 229376 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(64x0e+64x0e+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 56x0e -> 64x0e | 229376 paths | 229376 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-1): 2 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 56x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 56x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 15:16:50.508 INFO: Total number of parameters: 682144
2025-11-17 15:16:50.508 INFO: 
2025-11-17 15:16:50.509 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 15:16:50.509 INFO: Using ADAM as parameter optimizer
2025-11-17 15:16:50.509 INFO: Batch size: 1
2025-11-17 15:16:50.509 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 15:16:50.509 INFO: Number of gradient updates: 169000
2025-11-17 15:16:50.509 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 15:16:50.509 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 15:16:50.513 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 15:16:50.728 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 15:16:50.728 INFO: 
2025-11-17 15:16:50.728 INFO: ===========TRAINING===========
2025-11-17 15:16:50.728 INFO: Started training, reporting errors on validation set
2025-11-17 15:16:50.728 INFO: Loss metrics on validation set
2025-11-17 15:17:11.644 INFO: Initial: head: Default, loss=0.00685169, MAE_E_per_atom=   61.93 meV, MAE_F=None meV / A
2025-11-17 15:23:09.051 INFO: Epoch 0: head: Default, loss=0.00694396, MAE_E_per_atom=   56.73 meV, MAE_F=None meV / A
2025-11-17 15:23:09.053 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-17 15:26:09.641 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 15:26:09.642 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 15:26:09.642 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o.
2025-11-17 15:26:09.642 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 15:26:09.642 INFO: MACE version: 0.3.14
2025-11-17 15:26:09.642 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o, edge_irreps=None, num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f275b3c80d0>, compute_atomic_dipole=<function str2bool at 0x7f275b3c80d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 15:26:09.690 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 15:26:09.736 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:26:09.741 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:26:09.745 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 15:26:09.749 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 15:26:09.751 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 15:26:09.751 INFO: ===========LOADING INPUT DATA===========
2025-11-17 15:26:09.751 INFO: Using heads: ['Default']
2025-11-17 15:26:09.751 INFO: Using the key specifications to parse data:
2025-11-17 15:26:09.752 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 15:26:09.752 INFO: =============    Processing head Default     ===========
2025-11-17 15:26:09.752 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 15:26:16.661 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:26:17.980 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:26:18.788 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:26:18.863 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:26:18.864 INFO: No validation set provided, splitting training data instead.
2025-11-17 15:26:18.864 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 15:26:18.974 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:26:18.979 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:26:26.427 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:26:27.786 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:26:28.650 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:26:28.725 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:26:28.725 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 15:26:29.007 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 15:26:29.008 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 15:26:29.008 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 15:26:29.680 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 15:26:29.680 INFO: Processing datasets for head 'Default'
2025-11-17 15:28:38.554 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 15:28:38.555 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 15:28:53.724 INFO: Head 'Default' training dataset size: 7542
2025-11-17 15:28:53.725 INFO: Computing average number of neighbors
2025-11-17 15:29:41.701 WARNING: Unusual average number of neighbors: 115.4
2025-11-17 15:29:41.704 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 15:29:41.704 INFO: ===========MODEL DETAILS===========
2025-11-17 15:30:36.020 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 15:30:36.075 INFO: Building model
2025-11-17 15:30:36.075 INFO: Message passing with 64 channels and max_L=1 (64x0e+64x1o)
2025-11-17 15:30:36.075 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 15:30:36.075 INFO: 8 radial and 5 basis functions
2025-11-17 15:30:36.075 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 15:30:36.075 INFO: Distance transform for radial basis functions: None
2025-11-17 15:30:36.075 INFO: Hidden irreps: 64x0e+64x1o
2025-11-17 15:30:37.388 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(64x0e+64x0e+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-1): 2 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 15:30:37.393 INFO: Total number of parameters: 700832
2025-11-17 15:30:37.393 INFO: 
2025-11-17 15:30:37.393 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 15:30:37.393 INFO: Using ADAM as parameter optimizer
2025-11-17 15:30:37.393 INFO: Batch size: 1
2025-11-17 15:30:37.393 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 15:30:37.393 INFO: Number of gradient updates: 754200
2025-11-17 15:30:37.393 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 15:30:37.393 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 15:30:37.395 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 15:30:37.615 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 15:30:37.616 INFO: 
2025-11-17 15:30:37.616 INFO: ===========TRAINING===========
2025-11-17 15:30:37.616 INFO: Started training, reporting errors on validation set
2025-11-17 15:30:37.616 INFO: Loss metrics on validation set
2025-11-17 15:31:17.395 INFO: Initial: head: Default, loss=0.01201098, MAE_E_per_atom=   84.53 meV, MAE_F=None meV / A
2025-11-17 15:35:59.311 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 15:35:59.311 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 15:35:59.312 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o.
2025-11-17 15:35:59.312 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 15:35:59.312 INFO: MACE version: 0.3.14
2025-11-17 15:35:59.312 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o, edge_irreps=None, num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f76148c80d0>, compute_atomic_dipole=<function str2bool at 0x7f76148c80d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 15:35:59.397 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 15:35:59.437 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:35:59.439 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 15:35:59.441 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 15:35:59.442 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 15:35:59.444 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 15:35:59.444 INFO: ===========LOADING INPUT DATA===========
2025-11-17 15:35:59.444 INFO: Using heads: ['Default']
2025-11-17 15:35:59.444 INFO: Using the key specifications to parse data:
2025-11-17 15:35:59.444 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 15:35:59.444 INFO: =============    Processing head Default     ===========
2025-11-17 15:35:59.444 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 15:36:05.514 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:36:06.728 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:36:07.395 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:36:07.466 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:36:07.466 INFO: No validation set provided, splitting training data instead.
2025-11-17 15:36:07.466 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 15:36:07.510 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:36:07.514 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:36:13.742 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 15:36:14.982 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 15:36:15.629 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:36:15.700 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 15:36:15.701 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 15:36:15.957 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 15:36:15.957 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 15:36:15.957 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 15:36:16.610 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 15:36:16.610 INFO: Processing datasets for head 'Default'
2025-11-17 15:37:56.790 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 15:37:56.790 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 15:38:09.835 INFO: Head 'Default' training dataset size: 7542
2025-11-17 15:38:09.836 INFO: Computing average number of neighbors
2025-11-17 15:38:57.906 INFO: Average number of neighbors: 95.33879089355469
2025-11-17 15:38:57.907 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 15:38:57.907 INFO: ===========MODEL DETAILS===========
2025-11-17 15:39:51.005 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 15:39:51.096 INFO: Building model
2025-11-17 15:39:51.096 INFO: Message passing with 64 channels and max_L=1 (64x0e+64x1o)
2025-11-17 15:39:51.096 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 15:39:51.096 INFO: 8 radial and 5 basis functions
2025-11-17 15:39:51.096 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-11-17 15:39:51.096 INFO: Distance transform for radial basis functions: None
2025-11-17 15:39:51.096 INFO: Hidden irreps: 64x0e+64x1o
2025-11-17 15:39:52.561 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(64x0e+64x0e+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-1): 2 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 15:39:52.571 INFO: Total number of parameters: 700832
2025-11-17 15:39:52.572 INFO: 
2025-11-17 15:39:52.572 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 15:39:52.573 INFO: Using ADAM as parameter optimizer
2025-11-17 15:39:52.573 INFO: Batch size: 1
2025-11-17 15:39:52.573 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 15:39:52.573 INFO: Number of gradient updates: 754200
2025-11-17 15:39:52.573 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 15:39:52.573 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 15:39:52.575 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 15:39:52.928 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 15:39:52.928 INFO: 
2025-11-17 15:39:52.928 INFO: ===========TRAINING===========
2025-11-17 15:39:52.928 INFO: Started training, reporting errors on validation set
2025-11-17 15:39:52.929 INFO: Loss metrics on validation set
2025-11-17 15:40:26.246 INFO: Initial: head: Default, loss=0.01064407, MAE_E_per_atom=   80.50 meV, MAE_F=None meV / A
2025-11-17 16:04:42.262 INFO: Epoch 0: head: Default, loss=0.00318514, MAE_E_per_atom=   39.51 meV, MAE_F=None meV / A
2025-11-17 16:04:42.264 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-17 16:29:30.196 INFO: Epoch 1: head: Default, loss=0.00275942, MAE_E_per_atom=   39.43 meV, MAE_F=None meV / A
2025-11-17 16:29:30.198 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-17 16:29:30.201 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-1.pt
2025-11-17 16:47:27.662 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 16:47:27.662 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 16:47:27.662 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 16:47:27.662 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 16:47:27.662 INFO: MACE version: 0.3.14
2025-11-17 16:47:27.662 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f4c231c80d0>, compute_atomic_dipole=<function str2bool at 0x7f4c231c80d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 16:47:27.701 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 16:47:27.746 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 16:47:27.748 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 16:47:27.749 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 16:47:27.750 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 16:47:27.752 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 16:47:27.752 INFO: ===========LOADING INPUT DATA===========
2025-11-17 16:47:27.752 INFO: Using heads: ['Default']
2025-11-17 16:47:27.752 INFO: Using the key specifications to parse data:
2025-11-17 16:47:27.752 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 16:47:27.752 INFO: =============    Processing head Default     ===========
2025-11-17 16:47:27.752 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 16:47:34.621 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 16:47:35.881 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 16:47:36.895 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:47:36.973 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:47:36.973 INFO: No validation set provided, splitting training data instead.
2025-11-17 16:47:36.974 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 16:47:37.056 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:47:37.061 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:47:43.939 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 16:47:45.163 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 16:47:45.848 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:47:45.904 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:47:45.905 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 16:47:46.170 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 16:47:46.170 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 16:47:46.170 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 16:47:46.818 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 16:47:46.818 INFO: Processing datasets for head 'Default'
2025-11-17 16:48:57.018 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 16:48:57.018 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 16:49:04.116 INFO: Head 'Default' training dataset size: 7542
2025-11-17 16:49:04.117 INFO: Computing average number of neighbors
2025-11-17 16:49:23.058 INFO: Average number of neighbors: 95.33879089355469
2025-11-17 16:49:23.058 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 16:49:23.059 INFO: ===========MODEL DETAILS===========
2025-11-17 16:50:29.678 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 16:50:29.723 INFO: Building model
2025-11-17 16:50:29.724 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 16:50:29.724 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 16:50:29.724 INFO: 8 radial and 5 basis functions
2025-11-17 16:50:29.724 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-11-17 16:50:29.724 INFO: Distance transform for radial basis functions: None
2025-11-17 16:50:29.724 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 16:50:31.951 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o+64x2e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 16:50:31.955 INFO: Total number of parameters: 796064
2025-11-17 16:50:31.955 INFO: 
2025-11-17 16:50:31.955 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 16:50:31.955 INFO: Using ADAM as parameter optimizer
2025-11-17 16:50:31.955 INFO: Batch size: 2
2025-11-17 16:50:31.955 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 16:50:31.955 INFO: Number of gradient updates: 377100
2025-11-17 16:50:31.955 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 16:50:31.955 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 16:50:31.956 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 16:50:32.163 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 16:50:32.164 INFO: 
2025-11-17 16:50:32.164 INFO: ===========TRAINING===========
2025-11-17 16:50:32.164 INFO: Started training, reporting errors on validation set
2025-11-17 16:50:32.164 INFO: Loss metrics on validation set
2025-11-17 16:50:53.017 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 16:50:53.017 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 16:50:53.017 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 16:50:53.017 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 16:50:53.018 INFO: MACE version: 0.3.14
2025-11-17 16:50:53.018 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f5fcc5c80d0>, compute_atomic_dipole=<function str2bool at 0x7f5fcc5c80d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 16:50:53.106 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 16:50:53.165 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 16:50:53.167 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 16:50:53.173 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 16:50:53.177 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 16:50:53.179 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 16:50:53.179 INFO: ===========LOADING INPUT DATA===========
2025-11-17 16:50:53.179 INFO: Using heads: ['Default']
2025-11-17 16:50:53.179 INFO: Using the key specifications to parse data:
2025-11-17 16:50:53.179 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 16:50:53.179 INFO: =============    Processing head Default     ===========
2025-11-17 16:50:53.180 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 16:50:59.540 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 16:51:00.736 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 16:51:01.395 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:51:01.436 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:51:01.436 INFO: No validation set provided, splitting training data instead.
2025-11-17 16:51:01.437 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 16:51:01.483 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:51:01.488 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:51:07.716 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 16:51:08.862 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 16:51:09.524 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:51:09.587 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:51:09.587 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 16:51:09.846 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 16:51:09.846 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 16:51:09.846 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 16:51:10.458 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 16:51:10.458 INFO: Processing datasets for head 'Default'
2025-11-17 16:52:39.903 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 16:52:39.903 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 16:52:47.429 INFO: Head 'Default' training dataset size: 7542
2025-11-17 16:52:47.430 INFO: Computing average number of neighbors
2025-11-17 16:53:40.008 INFO: Average number of neighbors: 95.33879089355469
2025-11-17 16:53:40.009 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 16:53:40.009 INFO: ===========MODEL DETAILS===========
2025-11-17 16:55:10.671 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 16:55:10.780 INFO: Building model
2025-11-17 16:55:10.780 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 16:55:10.780 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 16:55:10.781 INFO: 8 radial and 5 basis functions
2025-11-17 16:55:10.781 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-11-17 16:55:10.781 INFO: Distance transform for radial basis functions: None
2025-11-17 16:55:10.781 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 16:55:12.501 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o+64x2e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 16:55:12.504 INFO: Total number of parameters: 796064
2025-11-17 16:55:12.504 INFO: 
2025-11-17 16:55:12.504 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 16:55:12.504 INFO: Using ADAM as parameter optimizer
2025-11-17 16:55:12.504 INFO: Batch size: 1
2025-11-17 16:55:12.504 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 16:55:12.505 INFO: Number of gradient updates: 754200
2025-11-17 16:55:12.505 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 16:55:12.505 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 16:55:12.505 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 16:55:12.705 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 16:55:12.705 INFO: 
2025-11-17 16:55:12.705 INFO: ===========TRAINING===========
2025-11-17 16:55:12.705 INFO: Started training, reporting errors on validation set
2025-11-17 16:55:12.705 INFO: Loss metrics on validation set
2025-11-17 16:56:16.014 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 16:56:16.014 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 16:56:16.014 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o.
2025-11-17 16:56:16.014 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 16:56:16.014 INFO: MACE version: 0.3.14
2025-11-17 16:56:16.015 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o, edge_irreps=None, num_channels=64, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f1a84fcc0d0>, compute_atomic_dipole=<function str2bool at 0x7f1a84fcc0d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 16:56:16.115 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 16:56:16.174 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 16:56:16.176 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 16:56:16.179 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 16:56:16.180 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 16:56:16.182 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 16:56:16.182 INFO: ===========LOADING INPUT DATA===========
2025-11-17 16:56:16.182 INFO: Using heads: ['Default']
2025-11-17 16:56:16.182 INFO: Using the key specifications to parse data:
2025-11-17 16:56:16.183 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 16:56:16.183 INFO: =============    Processing head Default     ===========
2025-11-17 16:56:16.183 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 16:56:23.415 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 16:56:24.713 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 16:56:25.528 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:56:25.611 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:56:25.611 INFO: No validation set provided, splitting training data instead.
2025-11-17 16:56:25.612 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 16:56:25.685 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:56:25.690 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:56:33.070 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 16:56:34.352 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 16:56:35.245 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:56:35.337 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 16:56:35.338 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 16:56:35.640 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 16:56:35.640 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 16:56:35.640 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 16:56:36.343 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 16:56:36.343 INFO: Processing datasets for head 'Default'
2025-11-17 16:58:35.190 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 16:58:35.191 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 16:58:48.330 INFO: Head 'Default' training dataset size: 7542
2025-11-17 16:58:48.331 INFO: Computing average number of neighbors
2025-11-17 17:00:13.946 INFO: Average number of neighbors: 95.33879089355469
2025-11-17 17:00:13.947 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 17:00:13.947 INFO: ===========MODEL DETAILS===========
2025-11-17 17:02:03.583 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 17:02:03.635 INFO: Building model
2025-11-17 17:02:03.636 INFO: Message passing with 64 channels and max_L=1 (64x0e+64x1o)
2025-11-17 17:02:03.636 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 17:02:03.636 INFO: 8 radial and 5 basis functions
2025-11-17 17:02:03.636 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-11-17 17:02:03.636 INFO: Distance transform for radial basis functions: None
2025-11-17 17:02:03.636 INFO: Hidden irreps: 64x0e+64x1o
2025-11-17 17:02:04.848 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
      (conv_tp): TensorProduct(64x0e+64x1o x 1x0e+1x1o+1x2e+1x3o -> 128x0e+192x1o+192x2e+128x3o | 640 paths | 640 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 640]
      (linear): Linear(64x0e+64x0e+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 40960 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-1): 2 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o -> 64x0e+64x1o | 8192 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 17:02:04.851 INFO: Total number of parameters: 700832
2025-11-17 17:02:04.852 INFO: 
2025-11-17 17:02:04.852 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 17:02:04.852 INFO: Using ADAM as parameter optimizer
2025-11-17 17:02:04.852 INFO: Batch size: 1
2025-11-17 17:02:04.852 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 17:02:04.852 INFO: Number of gradient updates: 754200
2025-11-17 17:02:04.852 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 17:02:04.852 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 17:02:04.852 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 17:02:05.050 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 17:02:05.051 INFO: 
2025-11-17 17:02:05.051 INFO: ===========TRAINING===========
2025-11-17 17:02:05.051 INFO: Started training, reporting errors on validation set
2025-11-17 17:02:05.051 INFO: Loss metrics on validation set
2025-11-17 17:02:41.510 INFO: Initial: head: Default, loss=0.01064409, MAE_E_per_atom=   80.50 meV, MAE_F=None meV / A
2025-11-17 17:32:57.195 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 17:32:57.195 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 17:32:57.195 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 17:32:57.195 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 17:32:57.195 INFO: MACE version: 0.3.14
2025-11-17 17:32:57.195 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f8c485c80d0>, compute_atomic_dipole=<function str2bool at 0x7f8c485c80d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 17:32:57.293 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 17:32:57.349 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:32:57.350 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:32:57.352 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 17:32:57.353 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 17:32:57.354 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 17:32:57.354 INFO: ===========LOADING INPUT DATA===========
2025-11-17 17:32:57.354 INFO: Using heads: ['Default']
2025-11-17 17:32:57.354 INFO: Using the key specifications to parse data:
2025-11-17 17:32:57.354 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 17:32:57.354 INFO: =============    Processing head Default     ===========
2025-11-17 17:32:57.354 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 17:33:03.866 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:33:05.269 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:33:06.030 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:33:06.103 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:33:06.104 INFO: No validation set provided, splitting training data instead.
2025-11-17 17:33:06.105 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 17:33:06.195 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:33:06.200 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:33:13.162 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:33:14.334 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:33:15.018 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:33:15.074 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:33:15.074 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 17:33:15.330 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 17:33:15.331 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 17:33:15.331 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 17:33:15.943 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 17:33:15.943 INFO: Processing datasets for head 'Default'
2025-11-17 17:35:22.960 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 17:35:22.960 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 17:35:37.228 INFO: Head 'Default' training dataset size: 7542
2025-11-17 17:35:37.229 INFO: Computing average number of neighbors
2025-11-17 17:36:13.482 WARNING: Unusual average number of neighbors: 115.4
2025-11-17 17:36:13.483 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 17:36:13.483 INFO: ===========MODEL DETAILS===========
2025-11-17 17:36:51.185 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 17:36:51.258 INFO: Building model
2025-11-17 17:36:51.258 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 17:36:51.258 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 17:36:51.258 INFO: 8 radial and 5 basis functions
2025-11-17 17:36:51.258 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 17:36:51.258 INFO: Distance transform for radial basis functions: None
2025-11-17 17:36:51.258 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 17:36:52.547 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o+64x2e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 17:36:52.550 INFO: Total number of parameters: 796064
2025-11-17 17:36:52.550 INFO: 
2025-11-17 17:36:52.550 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 17:36:52.550 INFO: Using ADAM as parameter optimizer
2025-11-17 17:36:52.550 INFO: Batch size: 1
2025-11-17 17:36:52.550 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 17:36:52.550 INFO: Number of gradient updates: 754200
2025-11-17 17:36:52.550 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 17:36:52.550 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 17:36:52.551 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 17:36:52.743 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 17:36:52.743 INFO: 
2025-11-17 17:36:52.743 INFO: ===========TRAINING===========
2025-11-17 17:36:52.743 INFO: Started training, reporting errors on validation set
2025-11-17 17:36:52.743 INFO: Loss metrics on validation set
2025-11-17 17:37:19.529 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 17:37:19.530 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 17:37:19.530 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 17:37:19.530 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 17:37:19.530 INFO: MACE version: 0.3.14
2025-11-17 17:37:19.530 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f4dd3ec80d0>, compute_atomic_dipole=<function str2bool at 0x7f4dd3ec80d0>, train_file='../qmof_xyz/qmof_min_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_min_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 17:37:19.626 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 17:37:19.666 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:37:19.669 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:37:19.672 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 17:37:19.672 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 17:37:19.675 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 17:37:19.675 INFO: ===========LOADING INPUT DATA===========
2025-11-17 17:37:19.675 INFO: Using heads: ['Default']
2025-11-17 17:37:19.675 INFO: Using the key specifications to parse data:
2025-11-17 17:37:19.675 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 17:37:19.675 INFO: =============    Processing head Default     ===========
2025-11-17 17:37:19.676 DEBUG: Loading training file: ../qmof_xyz/qmof_min_training.extxyz
2025-11-17 17:37:26.593 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:37:27.863 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:37:28.592 INFO: Training set 1/1 [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:37:28.660 INFO: Total Training set [energy: 8379, stress: 0, virials: 0, dipole components: 0, head: 8379, elec_temp: 0, total_charge: 8379, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:37:28.660 INFO: No validation set provided, splitting training data instead.
2025-11-17 17:37:28.661 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 17:37:28.771 INFO: Random Split Training set [energy: 7542, stress: 0, virials: 0, dipole components: 0, head: 7542, elec_temp: 0, total_charge: 7542, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:37:28.777 INFO: Random Split Validation set [energy: 837, stress: 0, virials: 0, dipole components: 0, head: 837, elec_temp: 0, total_charge: 837, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:37:35.808 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:37:37.065 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_min_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:37:37.762 INFO: Test set 1/1 [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:37:37.824 INFO: Total Test set [energy: 8346, stress: 0, virials: 0, dipole components: 0, head: 8346, elec_temp: 0, total_charge: 8346, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:37:37.824 INFO: Total number of configurations: train=7542, valid=837, tests=[Default_Default: 8346],
2025-11-17 17:37:38.093 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 35, 38, 39, 40, 41, 42, 44, 46, 47, 48, 53, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 74, 75, 78, 79, 83, 92]
2025-11-17 17:37:38.093 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 17:37:38.093 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 17:37:38.718 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9036661731316507, 3: -5.566630451600039, 5: -8.486339328955294, 6: -8.980565517105603, 7: -7.887246523517125, 8: -6.678679235666545, 9: -4.125327831189162, 11: -4.642765695293901, 12: -6.904806612604689, 13: -8.442305323191713, 14: -7.027591660815411, 15: -8.050624809795067, 16: -4.051655967806064, 17: -2.5111798064804067, 20: -9.425295425116447, 21: -14.903011446761923, 22: -14.621120546797414, 23: -13.63210465191501, 24: -11.550790678925566, 25: -12.070531942184832, 26: -10.006117769597914, 27: -8.313940460858149, 28: -7.061019792682749, 29: -4.597150063976095, 30: -3.7099716849305677, 31: -6.733400946292109, 35: -1.944194156066943, 38: -9.085424242304828, 39: -15.490035615988138, 40: -16.18963457460685, 41: -18.399929494023144, 42: -14.477624601502313, 44: -9.406018531906001, 46: -5.142065525150219, 47: -2.7758490979609056, 48: -3.496717030931517, 53: -1.7292217369147913, 56: -9.815148937278618, 57: -14.965598603378643, 58: -13.779546346428416, 59: -14.240800345498531, 60: -14.389761069808603, 62: -14.325922458850547, 63: -13.885138329451589, 64: -14.359841210544188, 65: -14.489180447895453, 66: -14.453490112704145, 67: -14.368009330155704, 68: -14.504651845869173, 69: -14.938208428802977, 71: -13.43067078790526, 72: -16.581590392758912, 74: -16.292266340846712, 75: -14.554267498268437, 78: -6.692067052576049, 79: -2.9342415317006996, 83: -5.36398305903988, 92: -20.350243716398893}
2025-11-17 17:37:38.718 INFO: Processing datasets for head 'Default'
2025-11-17 17:39:30.887 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_min_training.extxyz']
2025-11-17 17:39:30.887 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 17:39:42.688 INFO: Head 'Default' training dataset size: 7542
2025-11-17 17:39:42.689 INFO: Computing average number of neighbors
2025-11-17 17:40:22.133 INFO: Average number of neighbors: 95.33879089355469
2025-11-17 17:40:22.134 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 17:40:22.134 INFO: ===========MODEL DETAILS===========
2025-11-17 17:41:00.968 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 17:41:01.065 INFO: Building model
2025-11-17 17:41:01.065 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 17:41:01.065 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 17:41:01.065 INFO: 8 radial and 5 basis functions
2025-11-17 17:41:01.065 INFO: Radial cutoff: 4.0 A (total receptive field for each atom: 8.0 A)
2025-11-17 17:41:01.065 INFO: Distance transform for radial basis functions: None
2025-11-17 17:41:01.065 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 17:41:02.435 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(58x0e -> 64x0e | 3712 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.0, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9037, -5.5666, -8.4863, -8.9806, -7.8872, -6.6787, -4.1253, -4.6428, -6.9048, -8.4423, -7.0276, -8.0506, -4.0517, -2.5112, -9.4253, -14.9030, -14.6211, -13.6321, -11.5508, -12.0705, -10.0061, -8.3139, -7.0610, -4.5971, -3.7100, -6.7334, -1.9442, -9.0854, -15.4900, -16.1896, -18.3999, -14.4776, -9.4060, -5.1421, -2.7758, -3.4967, -1.7292, -9.8151, -14.9656, -13.7795, -14.2408, -14.3898, -14.3259, -13.8851, -14.3598, -14.4892, -14.4535, -14.3680, -14.5047, -14.9382, -13.4307, -16.5816, -16.2923, -14.5543, -6.6921, -2.9342, -5.3640, -20.3502]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 58x0e -> 64x0e+64x1o+64x2e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 58x0e -> 64x0e | 237568 paths | 237568 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 58x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 17:41:02.437 INFO: Total number of parameters: 796064
2025-11-17 17:41:02.438 INFO: 
2025-11-17 17:41:02.438 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 17:41:02.438 INFO: Using ADAM as parameter optimizer
2025-11-17 17:41:02.438 INFO: Batch size: 1
2025-11-17 17:41:02.438 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 17:41:02.438 INFO: Number of gradient updates: 754200
2025-11-17 17:41:02.438 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 17:41:02.438 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 17:41:02.439 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 17:41:02.633 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 17:41:02.633 INFO: 
2025-11-17 17:41:02.633 INFO: ===========TRAINING===========
2025-11-17 17:41:02.633 INFO: Started training, reporting errors on validation set
2025-11-17 17:41:02.633 INFO: Loss metrics on validation set
2025-11-17 17:43:18.461 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 17:43:18.461 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 17:43:18.461 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 17:43:18.461 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 17:43:18.461 INFO: MACE version: 0.3.14
2025-11-17 17:43:18.461 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7fe13f7c80d0>, compute_atomic_dipole=<function str2bool at 0x7fe13f7c80d0>, train_file='../qmof_xyz/qmof_allatoms_training.extxyz', valid_file=None, valid_fraction=0.1, test_file='../qmof_xyz/qmof_allatoms_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 17:43:18.537 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 17:43:18.574 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:43:18.576 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:43:18.579 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 17:43:18.580 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 17:43:18.583 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 17:43:18.583 INFO: ===========LOADING INPUT DATA===========
2025-11-17 17:43:18.583 INFO: Using heads: ['Default']
2025-11-17 17:43:18.583 INFO: Using the key specifications to parse data:
2025-11-17 17:43:18.584 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 17:43:18.584 INFO: =============    Processing head Default     ===========
2025-11-17 17:43:18.584 DEBUG: Loading training file: ../qmof_xyz/qmof_allatoms_training.extxyz
2025-11-17 17:43:24.621 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:43:25.742 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:43:26.376 INFO: Training set 1/1 [energy: 9186, stress: 0, virials: 0, dipole components: 0, head: 9186, elec_temp: 0, total_charge: 9186, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:43:26.416 INFO: Total Training set [energy: 9186, stress: 0, virials: 0, dipole components: 0, head: 9186, elec_temp: 0, total_charge: 9186, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:43:26.416 INFO: No validation set provided, splitting training data instead.
2025-11-17 17:43:26.417 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-11-17 17:43:26.459 INFO: Random Split Training set [energy: 8268, stress: 0, virials: 0, dipole components: 0, head: 8268, elec_temp: 0, total_charge: 8268, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:43:26.463 INFO: Random Split Validation set [energy: 918, stress: 0, virials: 0, dipole components: 0, head: 918, elec_temp: 0, total_charge: 918, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:43:32.502 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:43:33.769 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:43:34.593 INFO: Test set 1/1 [energy: 9188, stress: 0, virials: 0, dipole components: 0, head: 9188, elec_temp: 0, total_charge: 9188, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:43:34.642 INFO: Total Test set [energy: 9188, stress: 0, virials: 0, dipole components: 0, head: 9188, elec_temp: 0, total_charge: 9188, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:43:34.643 INFO: Total number of configurations: train=8268, valid=918, tests=[Default_Default: 9188],
2025-11-17 17:43:34.910 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 55, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 74, 75, 77, 78, 79, 80, 81, 82, 83, 90, 92, 94]
2025-11-17 17:43:34.910 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 17:43:34.910 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 17:43:35.772 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.906524753729468, 3: -5.343421075374501, 5: -7.559576193109153, 6: -8.965368394343654, 7: -7.924493469652677, 8: -6.7482998421494855, 9: -4.083159488890212, 11: -4.579936452966804, 12: -7.043546977575758, 13: -7.774281480931176, 14: -7.466702708196815, 15: -8.002715035704563, 16: -4.075301754780868, 17: -2.565875146115303, 19: -3.889112667965057, 20: -8.87939038825289, 21: -14.439735354291706, 22: -14.379757456016794, 23: -13.25966081518608, 24: -10.908365010457006, 25: -11.727533377585317, 26: -9.918501155992844, 27: -8.152371407230593, 28: -6.640316832769545, 29: -4.414411236589396, 30: -3.531228911571211, 31: -4.396481718970903, 32: -6.095976556613985, 33: -4.087426870897902, 34: -2.571505134817233, 35: -2.043272065951517, 37: -4.186500293788145, 38: -8.695412842301703, 39: -15.50677412703084, 40: -16.148941965989867, 41: -18.516837116989787, 42: -14.362696348667932, 44: -9.08232632294207, 45: -7.4059137197827, 46: -5.384103905063438, 47: -2.8269985431430555, 48: -3.2960288035630407, 49: -5.135483785539728, 50: -4.926856495576041, 51: -6.769741297660282, 52: -2.4490504005100417, 53: -1.85452590074995, 55: -3.45977933408292, 56: -9.05941512370715, 57: -14.385226895422004, 58: -14.788468408112344, 59: -13.957532075517852, 60: -14.207944378101725, 62: -13.566486059720045, 63: -14.004347223226752, 64: -14.02483278773874, 65: -14.378916246529954, 66: -14.082353839097095, 67: -13.59117538325299, 68: -13.971179802392093, 69: -14.252117418022813, 70: -14.120166017462855, 71: -13.365016767896565, 72: -15.978551015656073, 74: -14.018753227107172, 75: -14.05301275929781, 77: -10.004614584047046, 78: -7.942323930005829, 79: -2.5767449855548876, 80: -1.2507972811052106, 81: -3.154826390489581, 82: -6.02698814075616, 83: -5.236209442758632, 90: -19.22480400988322, 92: -19.92441128812483, 94: -21.474734154068276}
2025-11-17 17:43:35.772 INFO: Processing datasets for head 'Default'
2025-11-17 17:44:07.649 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_allatoms_training.extxyz']
2025-11-17 17:44:07.649 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 17:44:11.633 INFO: Head 'Default' training dataset size: 8268
2025-11-17 17:44:11.635 INFO: Computing average number of neighbors
2025-11-17 17:44:45.396 INFO: Average number of neighbors: 33.07246398925781
2025-11-17 17:44:45.398 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 17:44:45.398 INFO: ===========MODEL DETAILS===========
2025-11-17 17:45:19.373 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 17:45:19.445 INFO: Building model
2025-11-17 17:45:19.445 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 17:45:19.445 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 17:45:19.445 INFO: 8 radial and 5 basis functions
2025-11-17 17:45:19.445 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 17:45:19.446 INFO: Distance transform for radial basis functions: None
2025-11-17 17:45:19.446 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 17:45:21.057 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(76x0e -> 64x0e | 4864 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9065, -5.3434, -7.5596, -8.9654, -7.9245, -6.7483, -4.0832, -4.5799, -7.0435, -7.7743, -7.4667, -8.0027, -4.0753, -2.5659, -3.8891, -8.8794, -14.4397, -14.3798, -13.2597, -10.9084, -11.7275, -9.9185, -8.1524, -6.6403, -4.4144, -3.5312, -4.3965, -6.0960, -4.0874, -2.5715, -2.0433, -4.1865, -8.6954, -15.5068, -16.1489, -18.5168, -14.3627, -9.0823, -7.4059, -5.3841, -2.8270, -3.2960, -5.1355, -4.9269, -6.7697, -2.4491, -1.8545, -3.4598, -9.0594, -14.3852, -14.7885, -13.9575, -14.2079, -13.5665, -14.0043, -14.0248, -14.3789, -14.0824, -13.5912, -13.9712, -14.2521, -14.1202, -13.3650, -15.9786, -14.0188, -14.0530, -10.0046, -7.9423, -2.5767, -1.2508, -3.1548, -6.0270, -5.2362, -19.2248, -19.9244, -21.4747]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 76x0e -> 64x0e+64x1o+64x2e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 76x0e -> 64x0e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 17:45:21.063 INFO: Total number of parameters: 973472
2025-11-17 17:45:21.063 INFO: 
2025-11-17 17:45:21.063 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 17:45:21.063 INFO: Using ADAM as parameter optimizer
2025-11-17 17:45:21.063 INFO: Batch size: 1
2025-11-17 17:45:21.063 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 17:45:21.063 INFO: Number of gradient updates: 826800
2025-11-17 17:45:21.063 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 17:45:21.063 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 17:45:21.064 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 17:45:21.296 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 17:45:21.296 INFO: 
2025-11-17 17:45:21.296 INFO: ===========TRAINING===========
2025-11-17 17:45:21.297 INFO: Started training, reporting errors on validation set
2025-11-17 17:45:21.297 INFO: Loss metrics on validation set
2025-11-17 17:45:53.631 INFO: Initial: head: Default, loss=0.00411635, MAE_E_per_atom=   44.72 meV, MAE_F=None meV / A
2025-11-17 17:49:51.657 INFO: ===========VERIFYING SETTINGS===========
2025-11-17 17:49:51.657 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-17 17:49:51.657 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-17 17:49:51.657 INFO: Stage Two is activated as start_stage_two was defined
2025-11-17 17:49:51.657 INFO: MACE version: 0.3.14
2025-11-17 17:49:51.657 DEBUG: Configuration: Namespace(config=None, name='qmof', seed=123, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float32', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomMAE', model='MACELES', r_max=4.5, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=2, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps=64x0e+64x1o+64x2e, edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7ff37a1c80d0>, compute_atomic_dipole=<function str2bool at 0x7ff37a1c80d0>, train_file='../qmof_xyz/qmof_allatoms_training.extxyz', valid_file='../qmof_xyz/qmof_allatoms_validation.extxyz', valid_fraction=0.1, test_file='../qmof_xyz/qmof_allatoms_testing.extxyz', test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=15, lr_scheduler_gamma=0.9993, swa=True, start_swa=50, lbfgs=False, ema=True, ema_decay=0.99, max_num_epochs=100, patience=50, foundation_model=None, foundation_model_readout=True, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-11-17 17:49:51.747 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-17 17:49:51.791 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:49:51.792 DEBUG: Popen(['git', 'version'], cwd=/home/michal/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-17 17:49:51.794 DEBUG: sys.platform='linux', git_executable='git'
2025-11-17 17:49:51.795 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/michal/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-17 17:49:51.797 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-17 17:49:51.797 INFO: ===========LOADING INPUT DATA===========
2025-11-17 17:49:51.797 INFO: Using heads: ['Default']
2025-11-17 17:49:51.797 INFO: Using the key specifications to parse data:
2025-11-17 17:49:51.797 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-17 17:49:51.797 INFO: =============    Processing head Default     ===========
2025-11-17 17:49:51.797 DEBUG: Loading training file: ../qmof_xyz/qmof_allatoms_training.extxyz
2025-11-17 17:49:59.356 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:50:00.623 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:50:01.453 INFO: Training set 1/1 [energy: 9186, stress: 0, virials: 0, dipole components: 0, head: 9186, elec_temp: 0, total_charge: 9186, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:50:01.523 INFO: Total Training set [energy: 9186, stress: 0, virials: 0, dipole components: 0, head: 9186, elec_temp: 0, total_charge: 9186, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:50:03.233 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:50:03.553 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_validation.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:50:04.083 INFO: Validation set 1/1 [energy: 2041, stress: 0, virials: 0, dipole components: 0, head: 2041, elec_temp: 0, total_charge: 2041, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:50:04.101 INFO: Total Validation set [energy: 2041, stress: 0, virials: 0, dipole components: 0, head: 2041, elec_temp: 0, total_charge: 2041, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:50:11.444 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-17 17:50:12.926 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-17 17:50:13.806 INFO: Test set 1/1 [energy: 9188, stress: 0, virials: 0, dipole components: 0, head: 9188, elec_temp: 0, total_charge: 9188, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:50:13.896 INFO: Total Test set [energy: 9188, stress: 0, virials: 0, dipole components: 0, head: 9188, elec_temp: 0, total_charge: 9188, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-17 17:50:13.896 INFO: Total number of configurations: train=9186, valid=2041, tests=[Default_Default: 9188],
2025-11-17 17:50:14.254 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 55, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 74, 75, 77, 78, 79, 80, 81, 82, 83, 90, 92, 94]
2025-11-17 17:50:14.255 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-17 17:50:14.255 INFO: Computing average Atomic Energies using least squares regression
2025-11-17 17:50:15.306 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9044873978953296, 3: -5.352148682565074, 5: -7.557113682208435, 6: -8.961658310575457, 7: -7.935327125811653, 8: -6.757115320001842, 9: -4.08167708897932, 11: -4.589701816771922, 12: -6.850279281707437, 13: -7.910608041432917, 14: -7.812098653620702, 15: -8.025622259716425, 16: -4.088295775674726, 17: -2.5745559530266804, 19: -4.002441259967947, 20: -8.85277162032613, 21: -14.423098269172186, 22: -14.33343624882076, 23: -13.23729944455031, 24: -11.160911907387236, 25: -11.756572795635039, 26: -9.901277928092437, 27: -8.201868654630449, 28: -6.659939365969881, 29: -4.401148771519253, 30: -3.511953242909118, 31: -4.4463966010909335, 32: -6.085892589710736, 33: -4.018271263914716, 34: -2.5936827171477965, 35: -2.0530138974254926, 37: -4.1639264691312405, 38: -8.699512534480455, 39: -15.504252645231201, 40: -16.05908839378556, 41: -18.50467453325801, 42: -14.346307476254902, 44: -9.054262961533357, 45: -7.480785846124345, 46: -5.392473449938949, 47: -2.8414413205533755, 48: -3.286055972127661, 49: -5.117815960999227, 50: -4.868035939295604, 51: -6.390099775520379, 52: -2.469839301250268, 53: -1.8861414698687575, 55: -3.4141144795984455, 56: -9.081918314798084, 57: -14.400406626369158, 58: -14.64441535079634, 59: -13.90720934089281, 60: -14.219142815126677, 62: -13.595819432195825, 63: -13.98161811997363, 64: -13.948203434773276, 65: -14.316039054008991, 66: -14.047458226882574, 67: -13.523813252408857, 68: -13.869926357494268, 69: -14.074628411219312, 70: -14.145664285162958, 71: -13.332587594910951, 72: -15.8782173048399, 74: -14.369503578198469, 75: -14.39481984458258, 77: -10.10678855954581, 78: -7.826854196076727, 79: -2.6004182439067294, 80: -1.2094746992744874, 81: -3.1405842667024912, 82: -6.0289815679978265, 83: -5.494308809565716, 90: -19.199232493574616, 92: -20.01663916680601, 94: -21.379070868182623}
2025-11-17 17:50:15.306 INFO: Processing datasets for head 'Default'
2025-11-17 17:51:32.508 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_allatoms_training.extxyz']
2025-11-17 17:51:32.509 INFO: Combining 1 list datasets for head 'Default'
2025-11-17 17:51:50.454 DEBUG: Successfully loaded validation dataset from ASE files: ['../qmof_xyz/qmof_allatoms_validation.extxyz']
2025-11-17 17:51:50.454 INFO: Combining 1 list datasets for head 'Default_valid'
2025-11-17 17:51:50.454 INFO: Combined validation datasets for Default
2025-11-17 17:51:50.455 INFO: Head 'Default' training dataset size: 9186
2025-11-17 17:51:50.455 INFO: Computing average number of neighbors
2025-11-17 17:52:30.507 INFO: Average number of neighbors: 33.066898345947266
2025-11-17 17:52:30.510 INFO: During training the following quantities will be reported: energy, forces
2025-11-17 17:52:30.510 INFO: ===========MODEL DETAILS===========
2025-11-17 17:53:06.525 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-17 17:53:06.609 INFO: Building model
2025-11-17 17:53:06.609 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-17 17:53:06.609 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-17 17:53:06.609 INFO: 8 radial and 5 basis functions
2025-11-17 17:53:06.609 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-17 17:53:06.609 INFO: Distance transform for radial basis functions: None
2025-11-17 17:53:06.609 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-17 17:53:09.040 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(76x0e -> 64x0e | 4864 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9045, -5.3521, -7.5571, -8.9617, -7.9353, -6.7571, -4.0817, -4.5897, -6.8503, -7.9106, -7.8121, -8.0256, -4.0883, -2.5746, -4.0024, -8.8528, -14.4231, -14.3334, -13.2373, -11.1609, -11.7566, -9.9013, -8.2019, -6.6599, -4.4011, -3.5120, -4.4464, -6.0859, -4.0183, -2.5937, -2.0530, -4.1639, -8.6995, -15.5043, -16.0591, -18.5047, -14.3463, -9.0543, -7.4808, -5.3925, -2.8414, -3.2861, -5.1178, -4.8680, -6.3901, -2.4698, -1.8861, -3.4141, -9.0819, -14.4004, -14.6444, -13.9072, -14.2191, -13.5958, -13.9816, -13.9482, -14.3160, -14.0475, -13.5238, -13.8699, -14.0746, -14.1457, -13.3326, -15.8782, -14.3695, -14.3948, -10.1068, -7.8269, -2.6004, -1.2095, -3.1406, -6.0290, -5.4943, -19.1992, -20.0166, -21.3791]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 76x0e -> 64x0e+64x1o+64x2e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 76x0e -> 64x0e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-17 17:53:09.044 INFO: Total number of parameters: 973472
2025-11-17 17:53:09.044 INFO: 
2025-11-17 17:53:09.044 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-17 17:53:09.045 INFO: Using ADAM as parameter optimizer
2025-11-17 17:53:09.045 INFO: Batch size: 1
2025-11-17 17:53:09.045 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-17 17:53:09.045 INFO: Number of gradient updates: 918600
2025-11-17 17:53:09.045 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-17 17:53:09.045 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-17 17:53:09.046 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-17 17:53:09.455 INFO: Using gradient clipping with tolerance=10.000
2025-11-17 17:53:09.456 INFO: 
2025-11-17 17:53:09.456 INFO: ===========TRAINING===========
2025-11-17 17:53:09.456 INFO: Started training, reporting errors on validation set
2025-11-17 17:53:09.456 INFO: Loss metrics on validation set
2025-11-17 17:54:14.263 INFO: Initial: head: Default, loss=0.00526462, MAE_E_per_atom=   47.98 meV, MAE_F=None meV / A
2025-11-17 18:25:43.703 INFO: Epoch 0: head: Default, loss=0.00179095, MAE_E_per_atom=   30.14 meV, MAE_F=None meV / A
2025-11-17 18:25:43.706 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-17 18:56:18.499 INFO: Epoch 1: head: Default, loss=0.00113514, MAE_E_per_atom=   24.41 meV, MAE_F=None meV / A
2025-11-17 18:56:18.503 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-17 18:56:18.507 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-1.pt
2025-11-17 19:26:29.506 INFO: Epoch 2: head: Default, loss=0.00108053, MAE_E_per_atom=   23.30 meV, MAE_F=None meV / A
2025-11-17 19:26:29.510 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-1.pt
2025-11-17 19:26:29.516 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-2.pt
2025-11-17 19:56:25.708 INFO: Epoch 3: head: Default, loss=0.00095778, MAE_E_per_atom=   22.10 meV, MAE_F=None meV / A
2025-11-17 19:56:25.712 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-2.pt
2025-11-17 19:56:25.718 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-3.pt
2025-11-17 20:25:51.701 INFO: Epoch 4: head: Default, loss=0.00085385, MAE_E_per_atom=   20.81 meV, MAE_F=None meV / A
2025-11-17 20:25:51.704 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-3.pt
2025-11-17 20:25:51.706 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-4.pt
2025-11-17 20:54:50.870 INFO: Epoch 5: head: Default, loss=0.00091652, MAE_E_per_atom=   21.44 meV, MAE_F=None meV / A
2025-11-17 21:23:48.515 INFO: Epoch 6: head: Default, loss=0.00088427, MAE_E_per_atom=   21.46 meV, MAE_F=None meV / A
2025-11-17 21:52:22.710 INFO: Epoch 7: head: Default, loss=0.00104054, MAE_E_per_atom=   22.97 meV, MAE_F=None meV / A
2025-11-17 22:13:41.496 INFO: Epoch 8: head: Default, loss=0.00086648, MAE_E_per_atom=   20.94 meV, MAE_F=None meV / A
2025-11-17 22:32:39.539 INFO: Epoch 9: head: Default, loss=0.00082227, MAE_E_per_atom=   20.43 meV, MAE_F=None meV / A
2025-11-17 22:32:39.541 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-4.pt
2025-11-17 22:32:39.543 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-9.pt
2025-11-17 22:51:42.790 INFO: Epoch 10: head: Default, loss=0.00084722, MAE_E_per_atom=   20.64 meV, MAE_F=None meV / A
2025-11-17 23:09:58.813 INFO: Epoch 11: head: Default, loss=0.00078772, MAE_E_per_atom=   19.75 meV, MAE_F=None meV / A
2025-11-17 23:09:58.815 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-9.pt
2025-11-17 23:09:58.817 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-11.pt
2025-11-17 23:28:07.840 INFO: Epoch 12: head: Default, loss=0.00084028, MAE_E_per_atom=   20.45 meV, MAE_F=None meV / A
2025-11-17 23:46:17.616 INFO: Epoch 13: head: Default, loss=0.00079690, MAE_E_per_atom=   19.96 meV, MAE_F=None meV / A
2025-11-18 00:04:40.827 INFO: Epoch 14: head: Default, loss=0.00075835, MAE_E_per_atom=   19.38 meV, MAE_F=None meV / A
2025-11-18 00:04:40.829 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-11.pt
2025-11-18 00:04:40.832 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-14.pt
2025-11-18 00:22:55.544 INFO: Epoch 15: head: Default, loss=0.00076801, MAE_E_per_atom=   19.53 meV, MAE_F=None meV / A
2025-11-18 00:41:06.481 INFO: Epoch 16: head: Default, loss=0.00079712, MAE_E_per_atom=   20.17 meV, MAE_F=None meV / A
2025-11-18 00:59:35.321 INFO: Epoch 17: head: Default, loss=0.00077620, MAE_E_per_atom=   19.50 meV, MAE_F=None meV / A
2025-11-18 01:17:54.469 INFO: Epoch 18: head: Default, loss=0.00076284, MAE_E_per_atom=   19.22 meV, MAE_F=None meV / A
2025-11-18 01:36:08.195 INFO: Epoch 19: head: Default, loss=0.00076104, MAE_E_per_atom=   19.54 meV, MAE_F=None meV / A
2025-11-18 01:54:31.125 INFO: Epoch 20: head: Default, loss=0.00081905, MAE_E_per_atom=   19.99 meV, MAE_F=None meV / A
2025-11-18 02:12:52.651 INFO: Epoch 21: head: Default, loss=0.00081290, MAE_E_per_atom=   20.05 meV, MAE_F=None meV / A
2025-11-18 02:31:03.294 INFO: Epoch 22: head: Default, loss=0.00080892, MAE_E_per_atom=   20.02 meV, MAE_F=None meV / A
2025-11-18 02:49:16.888 INFO: Epoch 23: head: Default, loss=0.00073820, MAE_E_per_atom=   19.30 meV, MAE_F=None meV / A
2025-11-18 02:49:16.890 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-14.pt
2025-11-18 02:49:16.893 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-23.pt
2025-11-18 03:08:16.052 INFO: Epoch 24: head: Default, loss=0.00080708, MAE_E_per_atom=   19.72 meV, MAE_F=None meV / A
2025-11-18 03:27:28.603 INFO: Epoch 25: head: Default, loss=0.00078815, MAE_E_per_atom=   19.55 meV, MAE_F=None meV / A
2025-11-18 03:46:46.250 INFO: Epoch 26: head: Default, loss=0.00075519, MAE_E_per_atom=   19.20 meV, MAE_F=None meV / A
2025-11-18 04:06:00.851 INFO: Epoch 27: head: Default, loss=0.00081978, MAE_E_per_atom=   19.84 meV, MAE_F=None meV / A
2025-11-18 04:25:19.466 INFO: Epoch 28: head: Default, loss=0.00077749, MAE_E_per_atom=   19.31 meV, MAE_F=None meV / A
2025-11-18 04:44:37.281 INFO: Epoch 29: head: Default, loss=0.00078065, MAE_E_per_atom=   19.33 meV, MAE_F=None meV / A
2025-11-18 05:03:54.564 INFO: Epoch 30: head: Default, loss=0.00077980, MAE_E_per_atom=   19.63 meV, MAE_F=None meV / A
2025-11-18 05:23:13.554 INFO: Epoch 31: head: Default, loss=0.00079202, MAE_E_per_atom=   19.72 meV, MAE_F=None meV / A
2025-11-18 05:42:33.101 INFO: Epoch 32: head: Default, loss=0.00079811, MAE_E_per_atom=   19.55 meV, MAE_F=None meV / A
2025-11-18 06:01:50.015 INFO: Epoch 33: head: Default, loss=0.00081533, MAE_E_per_atom=   19.63 meV, MAE_F=None meV / A
2025-11-18 06:21:09.328 INFO: Epoch 34: head: Default, loss=0.00083058, MAE_E_per_atom=   19.96 meV, MAE_F=None meV / A
2025-11-18 06:40:26.952 INFO: Epoch 35: head: Default, loss=0.00077216, MAE_E_per_atom=   19.13 meV, MAE_F=None meV / A
2025-11-18 06:59:48.963 INFO: Epoch 36: head: Default, loss=0.00076272, MAE_E_per_atom=   19.33 meV, MAE_F=None meV / A
2025-11-18 07:19:07.823 INFO: Epoch 37: head: Default, loss=0.00073425, MAE_E_per_atom=   19.00 meV, MAE_F=None meV / A
2025-11-18 07:19:07.825 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-23.pt
2025-11-18 07:19:07.828 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-37.pt
2025-11-18 07:38:22.184 INFO: Epoch 38: head: Default, loss=0.00078916, MAE_E_per_atom=   19.11 meV, MAE_F=None meV / A
2025-11-18 07:57:43.299 INFO: Epoch 39: head: Default, loss=0.00075220, MAE_E_per_atom=   19.06 meV, MAE_F=None meV / A
2025-11-18 08:17:12.084 INFO: Epoch 40: head: Default, loss=0.00076798, MAE_E_per_atom=   19.37 meV, MAE_F=None meV / A
2025-11-18 08:36:09.230 INFO: Epoch 41: head: Default, loss=0.00076542, MAE_E_per_atom=   19.36 meV, MAE_F=None meV / A
2025-11-18 08:58:54.879 INFO: Epoch 42: head: Default, loss=0.00078366, MAE_E_per_atom=   19.37 meV, MAE_F=None meV / A
2025-11-18 09:28:38.151 INFO: Epoch 43: head: Default, loss=0.00082246, MAE_E_per_atom=   19.94 meV, MAE_F=None meV / A
2025-11-18 09:57:06.658 INFO: Epoch 44: head: Default, loss=0.00074568, MAE_E_per_atom=   19.09 meV, MAE_F=None meV / A
2025-11-18 10:17:01.230 INFO: Epoch 45: head: Default, loss=0.00076680, MAE_E_per_atom=   19.49 meV, MAE_F=None meV / A
2025-11-18 10:36:56.870 INFO: Epoch 46: head: Default, loss=0.00077528, MAE_E_per_atom=   19.21 meV, MAE_F=None meV / A
2025-11-18 10:56:51.385 INFO: Epoch 47: head: Default, loss=0.00079794, MAE_E_per_atom=   19.47 meV, MAE_F=None meV / A
2025-11-18 11:15:59.916 INFO: Epoch 48: head: Default, loss=0.00079676, MAE_E_per_atom=   19.38 meV, MAE_F=None meV / A
2025-11-18 11:35:01.300 INFO: Epoch 49: head: Default, loss=0.00074620, MAE_E_per_atom=   18.92 meV, MAE_F=None meV / A
2025-11-18 11:35:01.301 INFO: Changing loss based on Stage Two Weights
2025-11-18 11:54:02.848 INFO: Epoch 50: head: Default, loss=0.07178771, MAE_E_per_atom=   18.76 meV, MAE_F=None meV / A
2025-11-18 11:54:02.850 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-50_swa.pt
2025-11-18 12:13:01.604 INFO: Epoch 51: head: Default, loss=0.07419922, MAE_E_per_atom=   18.74 meV, MAE_F=None meV / A
2025-11-18 12:32:01.788 INFO: Epoch 52: head: Default, loss=0.07342155, MAE_E_per_atom=   18.60 meV, MAE_F=None meV / A
2025-11-18 12:50:58.045 INFO: Epoch 53: head: Default, loss=0.07518892, MAE_E_per_atom=   18.81 meV, MAE_F=None meV / A
2025-11-18 13:11:46.631 INFO: Epoch 54: head: Default, loss=0.07526144, MAE_E_per_atom=   18.87 meV, MAE_F=None meV / A
2025-11-18 13:42:41.903 INFO: Epoch 55: head: Default, loss=0.07455258, MAE_E_per_atom=   18.88 meV, MAE_F=None meV / A
2025-11-18 14:13:50.846 INFO: Epoch 56: head: Default, loss=0.07917096, MAE_E_per_atom=   19.25 meV, MAE_F=None meV / A
2025-11-18 14:45:06.155 INFO: Epoch 57: head: Default, loss=0.07910783, MAE_E_per_atom=   19.08 meV, MAE_F=None meV / A
2025-11-18 15:15:57.647 INFO: Epoch 58: head: Default, loss=0.07673855, MAE_E_per_atom=   18.87 meV, MAE_F=None meV / A
2025-11-18 15:46:36.103 INFO: Epoch 59: head: Default, loss=0.07536107, MAE_E_per_atom=   18.90 meV, MAE_F=None meV / A
2025-11-18 16:17:13.207 INFO: Epoch 60: head: Default, loss=0.07944501, MAE_E_per_atom=   19.21 meV, MAE_F=None meV / A
2025-11-18 16:47:53.677 INFO: Epoch 61: head: Default, loss=0.07882187, MAE_E_per_atom=   19.14 meV, MAE_F=None meV / A
2025-11-18 17:17:35.682 INFO: Epoch 62: head: Default, loss=0.07664227, MAE_E_per_atom=   18.93 meV, MAE_F=None meV / A
2025-11-18 17:36:31.810 INFO: Epoch 63: head: Default, loss=0.08079567, MAE_E_per_atom=   19.19 meV, MAE_F=None meV / A
2025-11-18 17:55:25.422 INFO: Epoch 64: head: Default, loss=0.09013809, MAE_E_per_atom=   19.38 meV, MAE_F=None meV / A
2025-11-18 18:14:19.345 INFO: Epoch 65: head: Default, loss=0.07882991, MAE_E_per_atom=   19.08 meV, MAE_F=None meV / A
2025-11-18 18:32:58.476 INFO: Epoch 66: head: Default, loss=0.08771886, MAE_E_per_atom=   19.37 meV, MAE_F=None meV / A
2025-11-18 18:51:34.979 INFO: Epoch 67: head: Default, loss=0.12085230, MAE_E_per_atom=   19.75 meV, MAE_F=None meV / A
2025-11-18 19:10:12.882 INFO: Epoch 68: head: Default, loss=0.09590459, MAE_E_per_atom=   19.46 meV, MAE_F=None meV / A
2025-11-18 19:28:49.980 INFO: Epoch 69: head: Default, loss=0.11712527, MAE_E_per_atom=   19.83 meV, MAE_F=None meV / A
2025-11-18 19:47:27.454 INFO: Epoch 70: head: Default, loss=0.08695916, MAE_E_per_atom=   19.57 meV, MAE_F=None meV / A
2025-11-18 20:06:06.765 INFO: Epoch 71: head: Default, loss=0.09474856, MAE_E_per_atom=   19.47 meV, MAE_F=None meV / A
2025-11-18 20:24:42.856 INFO: Epoch 72: head: Default, loss=0.09810643, MAE_E_per_atom=   19.63 meV, MAE_F=None meV / A
2025-11-18 20:43:18.449 INFO: Epoch 73: head: Default, loss=0.10686838, MAE_E_per_atom=   19.66 meV, MAE_F=None meV / A
2025-11-18 21:01:50.649 INFO: Epoch 74: head: Default, loss=0.09422526, MAE_E_per_atom=   19.59 meV, MAE_F=None meV / A
2025-11-18 21:20:23.598 INFO: Epoch 75: head: Default, loss=0.09257990, MAE_E_per_atom=   19.52 meV, MAE_F=None meV / A
2025-11-18 21:38:56.769 INFO: Epoch 76: head: Default, loss=0.08625451, MAE_E_per_atom=   19.68 meV, MAE_F=None meV / A
2025-11-18 21:57:32.045 INFO: Epoch 77: head: Default, loss=0.08819088, MAE_E_per_atom=   19.49 meV, MAE_F=None meV / A
2025-11-18 22:16:07.089 INFO: Epoch 78: head: Default, loss=0.08453084, MAE_E_per_atom=   19.75 meV, MAE_F=None meV / A
2025-11-18 22:35:19.031 INFO: Epoch 79: head: Default, loss=0.09238426, MAE_E_per_atom=   19.84 meV, MAE_F=None meV / A
2025-11-18 22:54:14.875 INFO: Epoch 80: head: Default, loss=0.09302086, MAE_E_per_atom=   19.91 meV, MAE_F=None meV / A
2025-11-18 23:13:00.121 INFO: Epoch 81: head: Default, loss=0.08568109, MAE_E_per_atom=   19.88 meV, MAE_F=None meV / A
2025-11-18 23:31:50.494 INFO: Epoch 82: head: Default, loss=0.08930867, MAE_E_per_atom=   19.66 meV, MAE_F=None meV / A
2025-11-18 23:50:45.065 INFO: Epoch 83: head: Default, loss=0.08846083, MAE_E_per_atom=   20.07 meV, MAE_F=None meV / A
2025-11-19 00:09:42.931 INFO: Epoch 84: head: Default, loss=0.08774102, MAE_E_per_atom=   19.96 meV, MAE_F=None meV / A
2025-11-19 00:28:32.529 INFO: Epoch 85: head: Default, loss=0.08796245, MAE_E_per_atom=   20.19 meV, MAE_F=None meV / A
2025-11-19 00:47:29.457 INFO: Epoch 86: head: Default, loss=0.08468813, MAE_E_per_atom=   20.01 meV, MAE_F=None meV / A
2025-11-19 01:06:24.311 INFO: Epoch 87: head: Default, loss=0.08358335, MAE_E_per_atom=   19.68 meV, MAE_F=None meV / A
2025-11-19 01:25:17.147 INFO: Epoch 88: head: Default, loss=0.08732516, MAE_E_per_atom=   20.09 meV, MAE_F=None meV / A
2025-11-19 01:44:12.279 INFO: Epoch 89: head: Default, loss=0.08804189, MAE_E_per_atom=   19.88 meV, MAE_F=None meV / A
2025-11-19 02:03:09.115 INFO: Epoch 90: head: Default, loss=0.09031754, MAE_E_per_atom=   20.08 meV, MAE_F=None meV / A
2025-11-19 02:22:01.390 INFO: Epoch 91: head: Default, loss=0.08350468, MAE_E_per_atom=   19.84 meV, MAE_F=None meV / A
2025-11-19 02:40:51.492 INFO: Epoch 92: head: Default, loss=0.08475406, MAE_E_per_atom=   19.92 meV, MAE_F=None meV / A
2025-11-19 02:59:49.338 INFO: Epoch 93: head: Default, loss=0.08338505, MAE_E_per_atom=   19.72 meV, MAE_F=None meV / A
2025-11-19 03:18:47.265 INFO: Epoch 94: head: Default, loss=0.08373506, MAE_E_per_atom=   19.77 meV, MAE_F=None meV / A
2025-11-19 03:37:42.479 INFO: Epoch 95: head: Default, loss=0.08425245, MAE_E_per_atom=   19.86 meV, MAE_F=None meV / A
2025-11-19 03:56:41.170 INFO: Epoch 96: head: Default, loss=0.08513956, MAE_E_per_atom=   19.96 meV, MAE_F=None meV / A
2025-11-19 04:15:33.407 INFO: Epoch 97: head: Default, loss=0.08360709, MAE_E_per_atom=   19.83 meV, MAE_F=None meV / A
2025-11-19 04:34:28.539 INFO: Epoch 98: head: Default, loss=0.08716691, MAE_E_per_atom=   20.03 meV, MAE_F=None meV / A
2025-11-19 04:53:26.334 INFO: Epoch 99: head: Default, loss=0.08787657, MAE_E_per_atom=   20.08 meV, MAE_F=None meV / A
2025-11-19 04:53:26.335 INFO: Training complete
2025-11-19 04:53:26.335 INFO: 
2025-11-19 04:53:26.335 INFO: ===========RESULTS===========
2025-11-19 04:53:57.982 INFO: Loading checkpoint: ./checkpoints/qmof_run-123_epoch-37.pt
2025-11-19 04:53:58.037 INFO: Loaded Stage one model from epoch 37 for evaluation
2025-11-19 04:53:58.038 INFO: Saving model to checkpoints/qmof_run-123.model
2025-11-19 04:53:58.211 INFO: Compiling model, saving metadata to qmof_compiled.model
2025-11-19 04:53:58.818 INFO: Computing metrics for training, validation, and test sets
2025-11-19 04:53:58.820 INFO: Skipping evaluation for heads: ['pt_head']
2025-11-19 04:53:58.820 INFO: Evaluating train_Default ...
2025-11-19 05:28:51.407 INFO: Evaluating valid_Default ...
2025-11-19 05:29:36.559 INFO: Error-table on TRAIN and VALID:
+---------------+--------------------+-----------------+------------------+
|  config_type  | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+---------------+--------------------+-----------------+------------------+
| train_Default |          13.8      |       None      |       None       |
| valid_Default |          19.0      |       None      |       None       |
+---------------+--------------------+-----------------+------------------+
2025-11-19 05:29:36.559 INFO: Evaluating Default_Default ...
2025-11-19 05:33:10.476 INFO: Error-table on TEST:
+-----------------+--------------------+-----------------+------------------+
|   config_type   | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-----------------+--------------------+-----------------+------------------+
| Default_Default |          18.9      |       None      |       None       |
+-----------------+--------------------+-----------------+------------------+
2025-11-19 05:33:10.477 DEBUG: Running inference on train_Default dataset
2025-11-19 05:33:10.558 DEBUG: Plotting failed: too many indices for tensor of dimension 1
2025-11-19 05:33:10.558 INFO: Loading checkpoint: ./checkpoints/qmof_run-123_epoch-50_swa.pt
2025-11-19 05:33:10.618 INFO: Loaded Stage two model from epoch 50 for evaluation
2025-11-19 05:33:10.618 INFO: Saving model to checkpoints/qmof_run-123_stagetwo.model
2025-11-19 05:33:10.804 INFO: Compiling model, saving metadata qmof_stagetwo_compiled.model
2025-11-19 05:33:11.372 INFO: Computing metrics for training, validation, and test sets
2025-11-19 05:33:11.373 INFO: Skipping evaluation for heads: ['pt_head']
2025-11-19 05:33:11.373 INFO: Evaluating train_Default ...
2025-11-19 06:08:07.331 INFO: Evaluating valid_Default ...
2025-11-19 06:08:52.407 INFO: Error-table on TRAIN and VALID:
+---------------+--------------------+-----------------+------------------+
|  config_type  | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+---------------+--------------------+-----------------+------------------+
| train_Default |          11.9      |       None      |       None       |
| valid_Default |          18.8      |       None      |       None       |
+---------------+--------------------+-----------------+------------------+
2025-11-19 06:08:52.407 INFO: Evaluating Default_Default ...
2025-11-19 06:12:27.600 INFO: Error-table on TEST:
+-----------------+--------------------+-----------------+------------------+
|   config_type   | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-----------------+--------------------+-----------------+------------------+
| Default_Default |          18.6      |       None      |       None       |
+-----------------+--------------------+-----------------+------------------+
2025-11-19 06:12:27.601 DEBUG: Running inference on train_Default dataset
2025-11-19 06:12:27.671 DEBUG: Plotting failed: too many indices for tensor of dimension 1
2025-11-19 06:12:27.671 INFO: Done
2025-11-28 11:53:51.245 INFO: ===========VERIFYING SETTINGS===========
2025-11-28 11:53:51.246 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-28 11:53:51.246 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-28 11:53:51.246 INFO: Stage Two is activated as start_stage_two was defined
2025-11-28 11:53:51.246 INFO: MACE version: 0.3.14
2025-11-28 11:53:51.246 DEBUG: Configuration: Namespace(E0s='average', MLP_irreps='16x0e', allow_random_padding_pt=True, amsgrad=True, apply_cutoff=True, atomic_numbers=None, avg_num_neighbors=1, batch_size=4, beta=0.9, charges_key='REF_charges', checkpoints_dir='./checkpoints', clip_grad=10.0, compute_atomic_dipole=<function str2bool at 0x7bf8e0b57ca0>, compute_avg_num_neighbors=True, compute_forces=True, compute_polarizability=<function str2bool at 0x7bf8e0b57ca0>, compute_stress=False, config=None, config_type_weights='{"Default":1.0}', correlation=2, default_dtype='float32', device='cuda', dipole_key='dipole', dipole_weight=1.0, distance_transform='None', distributed=False, downloads_dir='./downloads', dry_run=False, edge_irreps=None, elec_temp_key='elec_temp', ema=True, ema_decay=0.99, embedding_specs=None, enable_cueq=False, enable_oeq=False, energy_key='energy', energy_weight=10.0, error_table='PerAtomMAE', eval_interval=1, filter_type_pt='none', force_mh_ft_lr=False, forces_key='REF_forces', forces_weight=0.0, foundation_filter_elements=True, foundation_head=None, foundation_model=None, foundation_model_elements=False, foundation_model_readout=True, gate='silu', head_key='head', heads=None, hidden_irreps=64x0e+64x1o+64x2e, huber_delta=0.01, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', keep_checkpoints=False, keep_isolated_atoms=False, key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}), launcher='slurm', lbfgs=False, les_arguments=None, log_dir='./logs', log_level='INFO', loss='weighted', lr=0.01, lr_factor=0.8, lr_scheduler_gamma=0.9993, max_L=2, max_ell=3, max_num_epochs=100, mean=None, model='MACELES', model_dir='.', multi_processed_test=False, multiheads_finetuning=True, name='qmof', num_channels=64, num_cutoff_basis=5, num_interactions=2, num_radial_basis=8, num_samples_pt=10000, num_workers=0, only_cueq=False, optimizer='adam', pair_repulsion=False, patience=50, pin_memory=True, plot=True, plot_frequency=0, plot_interaction_e=False, polarizability_key='polarizability', polarizability_weight=1.0, pseudolabel_replay=False, pt_train_file=None, pt_valid_file=None, r_max=4.5, radial_MLP='[64, 64, 64]', radial_type='bessel', real_pt_data_ratio_threshold=0.1, restart_latest=False, results_dir='./results', save_all_checkpoints=False, save_cpu=False, scaling='rms_forces_scaling', scheduler='ReduceLROnPlateau', scheduler_patience=15, seed=123, skip_evaluate_heads='pt_head', start_swa=50, statistics_file=None, std=None, stress_key='REF_stress', stress_weight=1.0, subselect_pt='random', swa=True, swa_dipole_weight=1.0, swa_energy_weight=1000.0, swa_forces_weight=100.0, swa_lr=0.001, swa_polarizability_weight=1.0, swa_stress_weight=10.0, swa_virials_weight=10.0, test_dir=None, test_file='../qmof_xyz/qmof_allatoms_noswap_testing.extxyz', total_charge_key='total_charge', total_spin_key='total_spin', train_file='../qmof_xyz/qmof_allatoms_noswap_training.extxyz', use_agnostic_product=False, use_embedding_readout=False, use_last_readout_only=False, use_reduced_cg=False, use_so3=False, valid_batch_size=10, valid_file='../qmof_xyz/qmof_allatoms_noswap_validation.extxyz', valid_fraction=0.1, virials_key='REF_virials', virials_weight=1.0, wandb=False, wandb_dir=None, wandb_entity='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], wandb_name='', wandb_project='', weight_decay=5e-07, weight_pt_head=1.0, work_dir='.')
2025-11-28 11:53:51.320 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-28 11:53:51.352 DEBUG: Popen(['git', 'version'], cwd=/home/go67wis/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-28 11:53:51.376 DEBUG: Popen(['git', 'version'], cwd=/home/go67wis/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-28 11:53:51.396 DEBUG: sys.platform='linux', git_executable='git'
2025-11-28 11:53:51.398 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/go67wis/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-28 11:53:51.418 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-28 11:53:51.419 INFO: ===========LOADING INPUT DATA===========
2025-11-28 11:53:51.419 INFO: Using heads: ['Default']
2025-11-28 11:53:51.419 INFO: Using the key specifications to parse data:
2025-11-28 11:53:51.419 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-28 11:53:51.419 INFO: =============    Processing head Default     ===========
2025-11-28 11:53:51.419 DEBUG: Loading training file: ../qmof_xyz/qmof_allatoms_noswap_training.extxyz
2025-11-28 11:53:57.242 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-28 11:53:58.393 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_noswap_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-28 11:53:58.970 INFO: Training set 1/1 [energy: 9174, stress: 0, virials: 0, dipole components: 0, head: 9174, elec_temp: 0, total_charge: 9174, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:53:59.010 INFO: Total Training set [energy: 9174, stress: 0, virials: 0, dipole components: 0, head: 9174, elec_temp: 0, total_charge: 9174, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:54:00.278 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-28 11:54:00.532 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_noswap_validation.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-28 11:54:00.655 INFO: Validation set 1/1 [energy: 2038, stress: 0, virials: 0, dipole components: 0, head: 2038, elec_temp: 0, total_charge: 2038, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:54:00.664 INFO: Total Validation set [energy: 2038, stress: 0, virials: 0, dipole components: 0, head: 2038, elec_temp: 0, total_charge: 2038, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:54:06.673 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-28 11:54:07.807 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_noswap_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-28 11:54:08.402 INFO: Test set 1/1 [energy: 9176, stress: 0, virials: 0, dipole components: 0, head: 9176, elec_temp: 0, total_charge: 9176, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:54:08.444 INFO: Total Test set [energy: 9176, stress: 0, virials: 0, dipole components: 0, head: 9176, elec_temp: 0, total_charge: 9176, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:54:08.444 INFO: Total number of configurations: train=9174, valid=2038, tests=[Default_Default: 9176],
2025-11-28 11:54:08.735 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 55, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 74, 75, 77, 78, 79, 80, 81, 82, 83, 90, 92, 94]
2025-11-28 11:54:08.735 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-28 11:54:08.735 INFO: Computing average Atomic Energies using least squares regression
2025-11-28 11:54:09.998 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9172128383086138, 3: -5.404552464121961, 5: -9.443298164285265, 6: -8.95619472884392, 7: -7.905525027678252, 8: -6.73111821909232, 9: -4.175955103884522, 11: -4.485948645700276, 12: -6.964141340055187, 13: -8.139861627306965, 14: -7.218185880493892, 15: -8.114841366386349, 16: -4.033785191454896, 17: -2.556566495249082, 19: -3.7145603965026557, 20: -9.557966498254576, 21: -15.124515346497615, 22: -15.273759532289647, 23: -13.431378276063395, 24: -11.5223279019861, 25: -11.972451521433694, 26: -9.971133877681195, 27: -8.17072117456786, 28: -6.891022265755379, 29: -4.491994120695544, 30: -3.6160657212694916, 31: -5.187929090341594, 32: -7.835836153626934, 33: -2.768467258939873, 34: -2.3450469564105427, 35: -1.976827539363851, 37: -4.2480998959112855, 38: -8.86109344514733, 39: -15.269880292130868, 40: -16.086229202871106, 41: -6.023695534575671, 42: -14.63652144248027, 44: -8.982018257619949, 45: -8.025569469103662, 46: -4.952322518164227, 47: -2.837230211031372, 48: -3.340125781010041, 49: -4.799497165963705, 50: -4.614823740061062, 51: -6.044869210780584, 52: -2.309823922301006, 53: -1.8296100729190066, 55: -3.8382327466742865, 56: -9.458205810086227, 57: -14.373421910022154, 58: -15.100081092731807, 59: -14.406245331283626, 60: -14.22259685033617, 62: -14.54001679125267, 63: -14.241172292861748, 64: -14.369228661270643, 65: -14.37529283914679, 66: -13.911574395047, 67: -14.105252158451181, 68: -14.035395707802099, 69: -14.396969227152912, 70: -13.686430129850233, 71: -14.597415612452641, 72: -16.313912425408752, 74: -16.69264859625814, 75: -14.369580234773595, 77: -7.987413103740628, 78: -4.546593254167114, 79: -2.9071857638343324, 80: -1.2002737528147334, 81: -3.0832694976444026, 82: -6.480608226700108, 83: -5.705882638564671, 90: -19.320042723407788, 92: -20.30230645056787, 94: 0.0}
2025-11-28 11:54:09.999 INFO: Processing datasets for head 'Default'
2025-11-28 11:54:36.605 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_allatoms_noswap_training.extxyz']
2025-11-28 11:54:36.605 INFO: Combining 1 list datasets for head 'Default'
2025-11-28 11:54:42.346 DEBUG: Successfully loaded validation dataset from ASE files: ['../qmof_xyz/qmof_allatoms_noswap_validation.extxyz']
2025-11-28 11:54:42.346 INFO: Combining 1 list datasets for head 'Default_valid'
2025-11-28 11:54:42.346 INFO: Combined validation datasets for Default
2025-11-28 11:54:42.346 INFO: Head 'Default' training dataset size: 9174
2025-11-28 11:54:42.347 INFO: Computing average number of neighbors
2025-11-28 11:54:49.387 INFO: Average number of neighbors: 32.668067932128906
2025-11-28 11:54:49.388 INFO: During training the following quantities will be reported: energy, forces
2025-11-28 11:54:49.388 INFO: ===========MODEL DETAILS===========
2025-11-28 11:54:55.775 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-28 11:54:55.787 INFO: Building model
2025-11-28 11:54:55.787 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-28 11:54:55.787 INFO: 2 layers, each with correlation order: 2 (body order: 3) and spherical harmonics up to: l=3
2025-11-28 11:54:55.787 INFO: 8 radial and 5 basis functions
2025-11-28 11:54:55.787 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-28 11:54:55.787 INFO: Distance transform for radial basis functions: None
2025-11-28 11:54:55.787 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-28 11:54:56.794 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(76x0e -> 64x0e | 4864 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9172, -5.4046, -9.4433, -8.9562, -7.9055, -6.7311, -4.1760, -4.4859, -6.9641, -8.1399, -7.2182, -8.1148, -4.0338, -2.5566, -3.7146, -9.5580, -15.1245, -15.2738, -13.4314, -11.5223, -11.9725, -9.9711, -8.1707, -6.8910, -4.4920, -3.6161, -5.1879, -7.8358, -2.7685, -2.3450, -1.9768, -4.2481, -8.8611, -15.2699, -16.0862, -6.0237, -14.6365, -8.9820, -8.0256, -4.9523, -2.8372, -3.3401, -4.7995, -4.6148, -6.0449, -2.3098, -1.8296, -3.8382, -9.4582, -14.3734, -15.1001, -14.4062, -14.2226, -14.5400, -14.2412, -14.3692, -14.3753, -13.9116, -14.1053, -14.0354, -14.3970, -13.6864, -14.5974, -16.3139, -16.6926, -14.3696, -7.9874, -4.5466, -2.9072, -1.2003, -3.0833, -6.4806, -5.7059, -19.3200, -20.3023, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 76x0e -> 64x0e+64x1o+64x2e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 76x0e -> 64x0e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0-2): 3 x Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
            )
            (weights): ParameterList(  (0): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)])
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-28 11:54:56.797 INFO: Total number of parameters: 973472
2025-11-28 11:54:56.797 INFO: 
2025-11-28 11:54:56.797 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-28 11:54:56.797 INFO: Using ADAM as parameter optimizer
2025-11-28 11:54:56.797 INFO: Batch size: 4
2025-11-28 11:54:56.797 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-28 11:54:56.797 INFO: Number of gradient updates: 229350
2025-11-28 11:54:56.797 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-28 11:54:56.797 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-28 11:54:56.798 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-28 11:54:56.890 INFO: Using gradient clipping with tolerance=10.000
2025-11-28 11:54:56.890 INFO: 
2025-11-28 11:54:56.890 INFO: ===========TRAINING===========
2025-11-28 11:54:56.890 INFO: Started training, reporting errors on validation set
2025-11-28 11:54:56.890 INFO: Loss metrics on validation set
2025-11-28 11:55:44.187 INFO: Initial: head: Default, loss=0.00548043, MAE_E_per_atom=   47.43 meV, MAE_F=None meV / A
2025-11-28 11:57:29.214 INFO: ===========VERIFYING SETTINGS===========
2025-11-28 11:57:29.214 WARNING: All of hidden_irreps, num_channels and max_L are specified
2025-11-28 11:57:29.214 WARNING: Using num_channels and max_L to create hidden_irreps: 64x0e+64x1o+64x2e.
2025-11-28 11:57:29.214 INFO: Stage Two is activated as start_stage_two was defined
2025-11-28 11:57:29.214 INFO: MACE version: 0.3.14
2025-11-28 11:57:29.214 DEBUG: Configuration: Namespace(E0s='average', MLP_irreps='16x0e', allow_random_padding_pt=True, amsgrad=True, apply_cutoff=True, atomic_numbers=None, avg_num_neighbors=1, batch_size=4, beta=0.9, charges_key='REF_charges', checkpoints_dir='./checkpoints', clip_grad=10.0, compute_atomic_dipole=<function str2bool at 0x77c2bc658ca0>, compute_avg_num_neighbors=True, compute_forces=True, compute_polarizability=<function str2bool at 0x77c2bc658ca0>, compute_stress=False, config=None, config_type_weights='{"Default":1.0}', correlation=3, default_dtype='float32', device='cuda', dipole_key='dipole', dipole_weight=1.0, distance_transform='None', distributed=False, downloads_dir='./downloads', dry_run=False, edge_irreps=None, elec_temp_key='elec_temp', ema=True, ema_decay=0.99, embedding_specs=None, enable_cueq=False, enable_oeq=False, energy_key='energy', energy_weight=10.0, error_table='PerAtomMAE', eval_interval=1, filter_type_pt='none', force_mh_ft_lr=False, forces_key='REF_forces', forces_weight=0.0, foundation_filter_elements=True, foundation_head=None, foundation_model=None, foundation_model_elements=False, foundation_model_readout=True, gate='silu', head_key='head', heads=None, hidden_irreps=64x0e+64x1o+64x2e, huber_delta=0.01, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', keep_checkpoints=False, keep_isolated_atoms=False, key_specification=KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}), launcher='slurm', lbfgs=False, les_arguments=None, log_dir='./logs', log_level='INFO', loss='weighted', lr=0.01, lr_factor=0.8, lr_scheduler_gamma=0.9993, max_L=2, max_ell=3, max_num_epochs=100, mean=None, model='MACELES', model_dir='.', multi_processed_test=False, multiheads_finetuning=True, name='qmof', num_channels=64, num_cutoff_basis=5, num_interactions=2, num_radial_basis=8, num_samples_pt=10000, num_workers=0, only_cueq=False, optimizer='adam', pair_repulsion=False, patience=50, pin_memory=True, plot=True, plot_frequency=0, plot_interaction_e=False, polarizability_key='polarizability', polarizability_weight=1.0, pseudolabel_replay=False, pt_train_file=None, pt_valid_file=None, r_max=4.5, radial_MLP='[64, 64, 64]', radial_type='bessel', real_pt_data_ratio_threshold=0.1, restart_latest=False, results_dir='./results', save_all_checkpoints=False, save_cpu=False, scaling='rms_forces_scaling', scheduler='ReduceLROnPlateau', scheduler_patience=15, seed=123, skip_evaluate_heads='pt_head', start_swa=50, statistics_file=None, std=None, stress_key='REF_stress', stress_weight=1.0, subselect_pt='random', swa=True, swa_dipole_weight=1.0, swa_energy_weight=1000.0, swa_forces_weight=100.0, swa_lr=0.001, swa_polarizability_weight=1.0, swa_stress_weight=10.0, swa_virials_weight=10.0, test_dir=None, test_file='../qmof_xyz/qmof_allatoms_noswap_testing.extxyz', total_charge_key='total_charge', total_spin_key='total_spin', train_file='../qmof_xyz/qmof_allatoms_noswap_training.extxyz', use_agnostic_product=False, use_embedding_readout=False, use_last_readout_only=False, use_reduced_cg=False, use_so3=False, valid_batch_size=10, valid_file='../qmof_xyz/qmof_allatoms_noswap_validation.extxyz', valid_fraction=0.1, virials_key='REF_virials', virials_weight=1.0, wandb=False, wandb_dir=None, wandb_entity='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], wandb_name='', wandb_project='', weight_decay=5e-07, weight_pt_head=1.0, work_dir='.')
2025-11-28 11:57:29.296 INFO: CUDA version: 12.1, CUDA device: 0
2025-11-28 11:57:29.317 DEBUG: Popen(['git', 'version'], cwd=/home/go67wis/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-28 11:57:29.351 DEBUG: Popen(['git', 'version'], cwd=/home/go67wis/les/qmof, stdin=None, shell=False, universal_newlines=False)
2025-11-28 11:57:29.377 DEBUG: sys.platform='linux', git_executable='git'
2025-11-28 11:57:29.378 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/go67wis/les, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-11-28 11:57:29.403 DEBUG: Current Git commit: 16e835035c9914f2fa20911072fef4315ffdcdd9
2025-11-28 11:57:29.404 INFO: ===========LOADING INPUT DATA===========
2025-11-28 11:57:29.404 INFO: Using heads: ['Default']
2025-11-28 11:57:29.404 INFO: Using the key specifications to parse data:
2025-11-28 11:57:29.404 INFO: Default: KeySpecification(info_keys={'energy': 'energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-11-28 11:57:29.404 INFO: =============    Processing head Default     ===========
2025-11-28 11:57:29.405 DEBUG: Loading training file: ../qmof_xyz/qmof_allatoms_noswap_training.extxyz
2025-11-28 11:57:35.470 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-28 11:57:36.593 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_noswap_training.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-28 11:57:37.205 INFO: Training set 1/1 [energy: 9174, stress: 0, virials: 0, dipole components: 0, head: 9174, elec_temp: 0, total_charge: 9174, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:57:37.246 INFO: Total Training set [energy: 9174, stress: 0, virials: 0, dipole components: 0, head: 9174, elec_temp: 0, total_charge: 9174, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:57:38.548 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-28 11:57:38.805 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_noswap_validation.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-28 11:57:38.935 INFO: Validation set 1/1 [energy: 2038, stress: 0, virials: 0, dipole components: 0, head: 2038, elec_temp: 0, total_charge: 2038, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:57:38.943 INFO: Total Validation set [energy: 2038, stress: 0, virials: 0, dipole components: 0, head: 2038, elec_temp: 0, total_charge: 2038, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:57:45.133 WARNING: Since ASE version 3.23.0b1, using energy_key 'energy' is no longer safe when communicating between MACE and ASE. We recommend using a different key, rewriting 'energy' to 'REF_energy'. You need to use --energy_key='REF_energy' to specify the chosen key name.
2025-11-28 11:57:46.259 WARNING: No forces found with key 'REF_forces' in '../qmof_xyz/qmof_allatoms_noswap_testing.extxyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-11-28 11:57:46.868 INFO: Test set 1/1 [energy: 9176, stress: 0, virials: 0, dipole components: 0, head: 9176, elec_temp: 0, total_charge: 9176, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:57:46.910 INFO: Total Test set [energy: 9176, stress: 0, virials: 0, dipole components: 0, head: 9176, elec_temp: 0, total_charge: 9176, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-11-28 11:57:46.910 INFO: Total number of configurations: train=9174, valid=2038, tests=[Default_Default: 9176],
2025-11-28 11:57:47.203 INFO: Atomic Numbers used: [1, 3, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 55, 56, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 74, 75, 77, 78, 79, 80, 81, 82, 83, 90, 92, 94]
2025-11-28 11:57:47.204 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-11-28 11:57:47.204 INFO: Computing average Atomic Energies using least squares regression
2025-11-28 11:57:48.465 INFO: Atomic Energies used (z: eV) for head Default: {1: -3.9172128383086138, 3: -5.404552464121961, 5: -9.443298164285265, 6: -8.95619472884392, 7: -7.905525027678252, 8: -6.73111821909232, 9: -4.175955103884522, 11: -4.485948645700276, 12: -6.964141340055187, 13: -8.139861627306965, 14: -7.218185880493892, 15: -8.114841366386349, 16: -4.033785191454896, 17: -2.556566495249082, 19: -3.7145603965026557, 20: -9.557966498254576, 21: -15.124515346497615, 22: -15.273759532289647, 23: -13.431378276063395, 24: -11.5223279019861, 25: -11.972451521433694, 26: -9.971133877681195, 27: -8.17072117456786, 28: -6.891022265755379, 29: -4.491994120695544, 30: -3.6160657212694916, 31: -5.187929090341594, 32: -7.835836153626934, 33: -2.768467258939873, 34: -2.3450469564105427, 35: -1.976827539363851, 37: -4.2480998959112855, 38: -8.86109344514733, 39: -15.269880292130868, 40: -16.086229202871106, 41: -6.023695534575671, 42: -14.63652144248027, 44: -8.982018257619949, 45: -8.025569469103662, 46: -4.952322518164227, 47: -2.837230211031372, 48: -3.340125781010041, 49: -4.799497165963705, 50: -4.614823740061062, 51: -6.044869210780584, 52: -2.309823922301006, 53: -1.8296100729190066, 55: -3.8382327466742865, 56: -9.458205810086227, 57: -14.373421910022154, 58: -15.100081092731807, 59: -14.406245331283626, 60: -14.22259685033617, 62: -14.54001679125267, 63: -14.241172292861748, 64: -14.369228661270643, 65: -14.37529283914679, 66: -13.911574395047, 67: -14.105252158451181, 68: -14.035395707802099, 69: -14.396969227152912, 70: -13.686430129850233, 71: -14.597415612452641, 72: -16.313912425408752, 74: -16.69264859625814, 75: -14.369580234773595, 77: -7.987413103740628, 78: -4.546593254167114, 79: -2.9071857638343324, 80: -1.2002737528147334, 81: -3.0832694976444026, 82: -6.480608226700108, 83: -5.705882638564671, 90: -19.320042723407788, 92: -20.30230645056787, 94: 0.0}
2025-11-28 11:57:48.465 INFO: Processing datasets for head 'Default'
2025-11-28 11:58:15.633 DEBUG: Successfully loaded dataset from ASE files: ['../qmof_xyz/qmof_allatoms_noswap_training.extxyz']
2025-11-28 11:58:15.633 INFO: Combining 1 list datasets for head 'Default'
2025-11-28 11:58:21.415 DEBUG: Successfully loaded validation dataset from ASE files: ['../qmof_xyz/qmof_allatoms_noswap_validation.extxyz']
2025-11-28 11:58:21.416 INFO: Combining 1 list datasets for head 'Default_valid'
2025-11-28 11:58:21.416 INFO: Combined validation datasets for Default
2025-11-28 11:58:21.416 INFO: Head 'Default' training dataset size: 9174
2025-11-28 11:58:21.416 INFO: Computing average number of neighbors
2025-11-28 11:58:28.382 INFO: Average number of neighbors: 32.668067932128906
2025-11-28 11:58:28.382 INFO: During training the following quantities will be reported: energy, forces
2025-11-28 11:58:28.382 INFO: ===========MODEL DETAILS===========
2025-11-28 11:58:34.542 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-11-28 11:58:34.550 INFO: Building model
2025-11-28 11:58:34.550 INFO: Message passing with 64 channels and max_L=2 (64x0e+64x1o+64x2e)
2025-11-28 11:58:34.550 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-11-28 11:58:34.550 INFO: 8 radial and 5 basis functions
2025-11-28 11:58:34.551 INFO: Radial cutoff: 4.5 A (total receptive field for each atom: 9.0 A)
2025-11-28 11:58:34.551 INFO: Distance transform for radial basis functions: None
2025-11-28 11:58:34.551 INFO: Hidden irreps: 64x0e+64x1o+64x2e
2025-11-28 11:58:36.217 DEBUG: MACELES(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(76x0e -> 64x0e | 4864 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.9172, -5.4046, -9.4433, -8.9562, -7.9055, -6.7311, -4.1760, -4.4859, -6.9641, -8.1399, -7.2182, -8.1148, -4.0338, -2.5566, -3.7146, -9.5580, -15.1245, -15.2738, -13.4314, -11.5223, -11.9725, -9.9711, -8.1707, -6.8910, -4.4920, -3.6161, -5.1879, -7.8358, -2.7685, -2.3450, -1.9768, -4.2481, -8.8611, -15.2699, -16.0862, -6.0237, -14.6365, -8.9820, -8.0256, -4.9523, -2.8372, -3.3401, -4.7995, -4.6148, -6.0449, -2.3098, -1.8296, -3.8382, -9.4582, -14.3734, -15.1001, -14.4062, -14.2226, -14.5400, -14.2412, -14.3692, -14.3753, -13.9116, -14.1053, -14.0354, -14.3970, -13.6864, -14.5974, -16.3139, -16.6926, -14.3696, -7.9874, -4.5466, -2.9072, -1.2003, -3.0833, -6.4806, -5.7059, -19.3200, -20.3023, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e -> 64x0e | 4096 weights)
      (conv_tp): TensorProduct(64x0e x 1x0e+1x1o+1x2e+1x3o -> 64x0e+64x1o+64x2e+64x3o | 256 paths | 256 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 256]
      (linear): Linear(64x0e+64x1o+64x2e+64x3o -> 64x0e+64x1o+64x2e+64x3o | 16384 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e x 76x0e -> 64x0e+64x1o+64x2e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
      (conv_tp): TensorProduct(64x0e+64x1o+64x2e x 1x0e+1x1o+1x2e+1x3o -> 192x0e+320x1o+320x2e+256x3o | 1088 paths | 1088 weights)
      (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1088]
      (linear): Linear(64x0e+64x0e+64x0e+64x1o+64x1o+64x1o+64x1o+64x1o+64x2e+64x2e+64x2e+64x2e+64x2e+64x3o+64x3o+64x3o+64x3o -> 64x0e+64x1o+64x2e+64x3o | 69632 weights)
      (skip_tp): FullyConnectedTensorProduct(64x0e+64x1o+64x2e x 76x0e -> 64x0e | 311296 paths | 311296 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 76x4x64 (cuda:0)]
                (1): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 76x6x64 (cuda:0)]
                (1): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 76x7x64 (cuda:0)]
                (1): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e+64x1o+64x2e -> 64x0e+64x1o+64x2e | 12288 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float32 of size 76x4x64 (cuda:0)]
                (1): Parameter containing: [torch.float32 of size 76x1x64 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(64x0e -> 64x0e | 4096 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.0000, shift=0.0000)
  (les): Les(
    (atomwise): _DummyAtomwise()
    (ewald): Ewald(dl=2.0, sigma=1.0, remove_self_interaction=True)
    (bec): BEC(remove_mean=True, epsilon_factor=1.0)
  )
  (les_readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(64x0e+64x1o+64x2e -> 1x0e | 64 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(64x0e -> 16x0e | 1024 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
)
2025-11-28 11:58:36.219 INFO: Total number of parameters: 1761440
2025-11-28 11:58:36.219 INFO: 
2025-11-28 11:58:36.219 INFO: ===========OPTIMIZER INFORMATION===========
2025-11-28 11:58:36.219 INFO: Using ADAM as parameter optimizer
2025-11-28 11:58:36.220 INFO: Batch size: 4
2025-11-28 11:58:36.220 INFO: Using Exponential Moving Average with decay: 0.99
2025-11-28 11:58:36.220 INFO: Number of gradient updates: 229350
2025-11-28 11:58:36.220 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-11-28 11:58:36.220 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=0.000)
2025-11-28 11:58:36.220 INFO: Stage Two (after 50 epochs) with loss function: WeightedEnergyForcesLoss(energy_weight=1000.000, forces_weight=100.000), with energy weight : 1000.0, forces weight : 100.0 and learning rate : 0.001
2025-11-28 11:58:36.312 INFO: Using gradient clipping with tolerance=10.000
2025-11-28 11:58:36.312 INFO: 
2025-11-28 11:58:36.312 INFO: ===========TRAINING===========
2025-11-28 11:58:36.312 INFO: Started training, reporting errors on validation set
2025-11-28 11:58:36.312 INFO: Loss metrics on validation set
2025-11-28 11:59:39.880 INFO: Initial: head: Default, loss=0.00543433, MAE_E_per_atom=   47.66 meV, MAE_F=None meV / A
2025-11-28 12:13:09.608 INFO: Epoch 0: head: Default, loss=0.00226765, MAE_E_per_atom=   25.07 meV, MAE_F=None meV / A
2025-11-28 12:13:09.610 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-28 12:26:22.854 INFO: Epoch 1: head: Default, loss=0.00182821, MAE_E_per_atom=   22.25 meV, MAE_F=None meV / A
2025-11-28 12:26:22.856 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-0.pt
2025-11-28 12:26:22.863 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-1.pt
2025-11-28 12:39:36.266 INFO: Epoch 2: head: Default, loss=0.00146571, MAE_E_per_atom=   18.46 meV, MAE_F=None meV / A
2025-11-28 12:39:36.267 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-1.pt
2025-11-28 12:39:36.275 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-2.pt
2025-11-28 12:52:48.449 INFO: Epoch 3: head: Default, loss=0.00142115, MAE_E_per_atom=   17.50 meV, MAE_F=None meV / A
2025-11-28 12:52:48.451 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-2.pt
2025-11-28 12:52:48.458 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-3.pt
2025-11-28 13:06:00.907 INFO: Epoch 4: head: Default, loss=0.00136267, MAE_E_per_atom=   17.26 meV, MAE_F=None meV / A
2025-11-28 13:06:00.909 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-3.pt
2025-11-28 13:06:00.916 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-4.pt
2025-11-28 13:19:13.179 INFO: Epoch 5: head: Default, loss=0.00131715, MAE_E_per_atom=   16.72 meV, MAE_F=None meV / A
2025-11-28 13:19:13.181 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-4.pt
2025-11-28 13:19:13.189 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-5.pt
2025-11-28 13:32:26.487 INFO: Epoch 6: head: Default, loss=0.00139964, MAE_E_per_atom=   18.03 meV, MAE_F=None meV / A
2025-11-28 13:45:38.998 INFO: Epoch 7: head: Default, loss=0.00127574, MAE_E_per_atom=   15.70 meV, MAE_F=None meV / A
2025-11-28 13:45:39.000 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-5.pt
2025-11-28 13:45:39.008 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-7.pt
2025-11-28 13:58:58.273 INFO: Epoch 8: head: Default, loss=0.00126119, MAE_E_per_atom=   15.89 meV, MAE_F=None meV / A
2025-11-28 13:58:58.275 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-7.pt
2025-11-28 13:58:58.283 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-8.pt
2025-11-28 14:12:14.834 INFO: Epoch 9: head: Default, loss=0.00124329, MAE_E_per_atom=   15.27 meV, MAE_F=None meV / A
2025-11-28 14:12:14.836 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-8.pt
2025-11-28 14:12:14.845 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-9.pt
2025-11-28 14:25:32.145 INFO: Epoch 10: head: Default, loss=0.00123960, MAE_E_per_atom=   15.07 meV, MAE_F=None meV / A
2025-11-28 14:25:32.147 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-9.pt
2025-11-28 14:25:32.156 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-10.pt
2025-11-28 14:38:48.472 INFO: Epoch 11: head: Default, loss=0.00123084, MAE_E_per_atom=   14.97 meV, MAE_F=None meV / A
2025-11-28 14:38:48.473 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-10.pt
2025-11-28 14:38:48.481 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-11.pt
2025-11-28 14:52:05.598 INFO: Epoch 12: head: Default, loss=0.00120830, MAE_E_per_atom=   14.75 meV, MAE_F=None meV / A
2025-11-28 14:52:05.600 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-11.pt
2025-11-28 14:52:05.608 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-12.pt
2025-11-28 15:05:22.012 INFO: Epoch 13: head: Default, loss=0.00122589, MAE_E_per_atom=   14.85 meV, MAE_F=None meV / A
2025-11-28 15:18:39.703 INFO: Epoch 14: head: Default, loss=0.00120361, MAE_E_per_atom=   14.63 meV, MAE_F=None meV / A
2025-11-28 15:18:39.705 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-12.pt
2025-11-28 15:18:39.713 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-14.pt
2025-11-28 15:31:57.814 INFO: Epoch 15: head: Default, loss=0.00121254, MAE_E_per_atom=   14.60 meV, MAE_F=None meV / A
2025-11-28 15:45:14.770 INFO: Epoch 16: head: Default, loss=0.00119371, MAE_E_per_atom=   14.45 meV, MAE_F=None meV / A
2025-11-28 15:45:14.772 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-14.pt
2025-11-28 15:45:14.779 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-16.pt
2025-11-28 15:58:31.274 INFO: Epoch 17: head: Default, loss=0.00118182, MAE_E_per_atom=   14.46 meV, MAE_F=None meV / A
2025-11-28 15:58:31.276 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-16.pt
2025-11-28 15:58:31.285 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-17.pt
2025-11-28 16:11:51.968 INFO: Epoch 18: head: Default, loss=0.00119683, MAE_E_per_atom=   14.26 meV, MAE_F=None meV / A
2025-11-28 16:25:08.654 INFO: Epoch 19: head: Default, loss=0.00115652, MAE_E_per_atom=   13.77 meV, MAE_F=None meV / A
2025-11-28 16:25:08.656 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-17.pt
2025-11-28 16:25:08.664 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-19.pt
2025-11-28 16:38:24.075 INFO: Epoch 20: head: Default, loss=0.00117167, MAE_E_per_atom=   14.10 meV, MAE_F=None meV / A
2025-11-28 16:51:41.108 INFO: Epoch 21: head: Default, loss=0.00115942, MAE_E_per_atom=   13.85 meV, MAE_F=None meV / A
2025-11-28 17:04:57.493 INFO: Epoch 22: head: Default, loss=0.00115168, MAE_E_per_atom=   13.65 meV, MAE_F=None meV / A
2025-11-28 17:04:57.495 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-19.pt
2025-11-28 17:04:57.502 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-22.pt
2025-11-28 17:18:29.508 INFO: Epoch 23: head: Default, loss=0.00119040, MAE_E_per_atom=   14.23 meV, MAE_F=None meV / A
2025-11-28 17:32:12.188 INFO: Epoch 24: head: Default, loss=0.00116036, MAE_E_per_atom=   13.61 meV, MAE_F=None meV / A
2025-11-28 17:45:27.958 INFO: Epoch 25: head: Default, loss=0.00120716, MAE_E_per_atom=   14.81 meV, MAE_F=None meV / A
2025-11-28 17:58:42.708 INFO: Epoch 26: head: Default, loss=0.00118073, MAE_E_per_atom=   14.35 meV, MAE_F=None meV / A
2025-11-28 18:11:57.820 INFO: Epoch 27: head: Default, loss=0.00114816, MAE_E_per_atom=   13.87 meV, MAE_F=None meV / A
2025-11-28 18:11:57.822 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-22.pt
2025-11-28 18:11:57.830 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-27.pt
2025-11-28 18:25:12.921 INFO: Epoch 28: head: Default, loss=0.00113332, MAE_E_per_atom=   13.50 meV, MAE_F=None meV / A
2025-11-28 18:25:12.923 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-27.pt
2025-11-28 18:25:12.932 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-28.pt
2025-11-28 18:38:30.693 INFO: Epoch 29: head: Default, loss=0.00114714, MAE_E_per_atom=   13.49 meV, MAE_F=None meV / A
2025-11-28 18:51:45.312 INFO: Epoch 30: head: Default, loss=0.00114569, MAE_E_per_atom=   13.42 meV, MAE_F=None meV / A
2025-11-28 19:04:57.705 INFO: Epoch 31: head: Default, loss=0.00114018, MAE_E_per_atom=   13.33 meV, MAE_F=None meV / A
2025-11-28 19:18:11.124 INFO: Epoch 32: head: Default, loss=0.00113400, MAE_E_per_atom=   13.29 meV, MAE_F=None meV / A
2025-11-28 19:31:28.753 INFO: Epoch 33: head: Default, loss=0.00113054, MAE_E_per_atom=   13.25 meV, MAE_F=None meV / A
2025-11-28 19:31:28.755 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-28.pt
2025-11-28 19:31:28.764 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-33.pt
2025-11-28 19:44:43.983 INFO: Epoch 34: head: Default, loss=0.00112561, MAE_E_per_atom=   13.07 meV, MAE_F=None meV / A
2025-11-28 19:44:43.985 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-33.pt
2025-11-28 19:44:43.993 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-34.pt
2025-11-28 19:58:01.085 INFO: Epoch 35: head: Default, loss=0.00113329, MAE_E_per_atom=   13.18 meV, MAE_F=None meV / A
2025-11-28 20:11:18.046 INFO: Epoch 36: head: Default, loss=0.00112131, MAE_E_per_atom=   13.12 meV, MAE_F=None meV / A
2025-11-28 20:11:18.048 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-34.pt
2025-11-28 20:11:18.056 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-36.pt
2025-11-28 20:24:35.166 INFO: Epoch 37: head: Default, loss=0.00112231, MAE_E_per_atom=   12.99 meV, MAE_F=None meV / A
2025-11-28 20:37:52.099 INFO: Epoch 38: head: Default, loss=0.00113484, MAE_E_per_atom=   13.18 meV, MAE_F=None meV / A
2025-11-28 20:51:07.229 INFO: Epoch 39: head: Default, loss=0.00113934, MAE_E_per_atom=   13.22 meV, MAE_F=None meV / A
2025-11-28 21:04:25.056 INFO: Epoch 40: head: Default, loss=0.00112580, MAE_E_per_atom=   13.04 meV, MAE_F=None meV / A
2025-11-28 21:17:43.280 INFO: Epoch 41: head: Default, loss=0.00110772, MAE_E_per_atom=   12.90 meV, MAE_F=None meV / A
2025-11-28 21:17:43.282 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-36.pt
2025-11-28 21:17:43.290 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-41.pt
2025-11-28 21:31:09.017 INFO: Epoch 42: head: Default, loss=0.00111822, MAE_E_per_atom=   12.82 meV, MAE_F=None meV / A
2025-11-28 21:44:29.568 INFO: Epoch 43: head: Default, loss=0.00112197, MAE_E_per_atom=   12.99 meV, MAE_F=None meV / A
2025-11-28 21:57:48.508 INFO: Epoch 44: head: Default, loss=0.00111848, MAE_E_per_atom=   13.16 meV, MAE_F=None meV / A
2025-11-28 22:11:08.157 INFO: Epoch 45: head: Default, loss=0.00110657, MAE_E_per_atom=   12.85 meV, MAE_F=None meV / A
2025-11-28 22:11:08.158 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-41.pt
2025-11-28 22:11:08.167 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-45.pt
2025-11-28 22:24:27.665 INFO: Epoch 46: head: Default, loss=0.00112527, MAE_E_per_atom=   13.22 meV, MAE_F=None meV / A
2025-11-28 22:37:44.633 INFO: Epoch 47: head: Default, loss=0.00110321, MAE_E_per_atom=   12.84 meV, MAE_F=None meV / A
2025-11-28 22:37:44.634 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-45.pt
2025-11-28 22:37:44.643 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-47.pt
2025-11-28 22:51:04.232 INFO: Epoch 48: head: Default, loss=0.00111018, MAE_E_per_atom=   12.84 meV, MAE_F=None meV / A
2025-11-28 23:04:24.360 INFO: Epoch 49: head: Default, loss=0.00111134, MAE_E_per_atom=   12.78 meV, MAE_F=None meV / A
2025-11-28 23:04:24.361 INFO: Changing loss based on Stage Two Weights
2025-11-28 23:17:42.403 INFO: Epoch 50: head: Default, loss=0.11031722, MAE_E_per_atom=   12.62 meV, MAE_F=None meV / A
2025-11-28 23:17:42.405 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-50_swa.pt
2025-11-28 23:30:56.653 INFO: Epoch 51: head: Default, loss=0.11053367, MAE_E_per_atom=   12.54 meV, MAE_F=None meV / A
2025-11-28 23:44:14.967 INFO: Epoch 52: head: Default, loss=0.10909147, MAE_E_per_atom=   12.38 meV, MAE_F=None meV / A
2025-11-28 23:44:14.969 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-50_swa.pt
2025-11-28 23:44:14.978 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-52_swa.pt
2025-11-28 23:57:31.918 INFO: Epoch 53: head: Default, loss=0.10958662, MAE_E_per_atom=   12.62 meV, MAE_F=None meV / A
2025-11-29 00:10:48.072 INFO: Epoch 54: head: Default, loss=0.10912600, MAE_E_per_atom=   12.37 meV, MAE_F=None meV / A
2025-11-29 00:24:07.966 INFO: Epoch 55: head: Default, loss=0.10919965, MAE_E_per_atom=   12.42 meV, MAE_F=None meV / A
2025-11-29 00:37:24.910 INFO: Epoch 56: head: Default, loss=0.10907417, MAE_E_per_atom=   12.32 meV, MAE_F=None meV / A
2025-11-29 00:37:24.912 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-52_swa.pt
2025-11-29 00:37:24.921 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-56_swa.pt
2025-11-29 00:50:41.526 INFO: Epoch 57: head: Default, loss=0.10882663, MAE_E_per_atom=   12.19 meV, MAE_F=None meV / A
2025-11-29 00:50:41.527 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-56_swa.pt
2025-11-29 00:50:41.536 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-57_swa.pt
2025-11-29 01:03:59.149 INFO: Epoch 58: head: Default, loss=0.10928233, MAE_E_per_atom=   12.27 meV, MAE_F=None meV / A
2025-11-29 01:17:14.344 INFO: Epoch 59: head: Default, loss=0.10885578, MAE_E_per_atom=   12.26 meV, MAE_F=None meV / A
2025-11-29 01:30:30.641 INFO: Epoch 60: head: Default, loss=0.10973858, MAE_E_per_atom=   12.31 meV, MAE_F=None meV / A
2025-11-29 01:43:46.827 INFO: Epoch 61: head: Default, loss=0.10907076, MAE_E_per_atom=   12.19 meV, MAE_F=None meV / A
2025-11-29 01:57:01.482 INFO: Epoch 62: head: Default, loss=0.10853840, MAE_E_per_atom=   12.16 meV, MAE_F=None meV / A
2025-11-29 01:57:01.484 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-57_swa.pt
2025-11-29 01:57:01.493 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-62_swa.pt
2025-11-29 02:10:18.339 INFO: Epoch 63: head: Default, loss=0.10886616, MAE_E_per_atom=   12.09 meV, MAE_F=None meV / A
2025-11-29 02:23:32.218 INFO: Epoch 64: head: Default, loss=0.10908691, MAE_E_per_atom=   12.15 meV, MAE_F=None meV / A
2025-11-29 02:36:46.285 INFO: Epoch 65: head: Default, loss=0.10839970, MAE_E_per_atom=   12.10 meV, MAE_F=None meV / A
2025-11-29 02:36:46.287 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-62_swa.pt
2025-11-29 02:36:46.296 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-65_swa.pt
2025-11-29 02:50:03.559 INFO: Epoch 66: head: Default, loss=0.10850115, MAE_E_per_atom=   12.07 meV, MAE_F=None meV / A
2025-11-29 03:03:18.388 INFO: Epoch 67: head: Default, loss=0.10776413, MAE_E_per_atom=   12.06 meV, MAE_F=None meV / A
2025-11-29 03:03:18.390 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-65_swa.pt
2025-11-29 03:03:18.398 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-67_swa.pt
2025-11-29 03:16:35.646 INFO: Epoch 68: head: Default, loss=0.10841490, MAE_E_per_atom=   11.99 meV, MAE_F=None meV / A
2025-11-29 03:29:52.605 INFO: Epoch 69: head: Default, loss=0.10806063, MAE_E_per_atom=   11.92 meV, MAE_F=None meV / A
2025-11-29 03:43:07.401 INFO: Epoch 70: head: Default, loss=0.10828437, MAE_E_per_atom=   11.91 meV, MAE_F=None meV / A
2025-11-29 03:56:23.765 INFO: Epoch 71: head: Default, loss=0.10833461, MAE_E_per_atom=   12.02 meV, MAE_F=None meV / A
2025-11-29 04:09:39.033 INFO: Epoch 72: head: Default, loss=0.10853759, MAE_E_per_atom=   11.91 meV, MAE_F=None meV / A
2025-11-29 04:22:53.403 INFO: Epoch 73: head: Default, loss=0.10929093, MAE_E_per_atom=   12.02 meV, MAE_F=None meV / A
2025-11-29 04:36:07.870 INFO: Epoch 74: head: Default, loss=0.10802998, MAE_E_per_atom=   11.86 meV, MAE_F=None meV / A
2025-11-29 04:49:22.308 INFO: Epoch 75: head: Default, loss=0.10839469, MAE_E_per_atom=   11.89 meV, MAE_F=None meV / A
2025-11-29 05:02:37.095 INFO: Epoch 76: head: Default, loss=0.10867470, MAE_E_per_atom=   11.92 meV, MAE_F=None meV / A
2025-11-29 05:15:49.758 INFO: Epoch 77: head: Default, loss=0.10720353, MAE_E_per_atom=   11.65 meV, MAE_F=None meV / A
2025-11-29 05:15:49.760 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-67_swa.pt
2025-11-29 05:15:49.769 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-77_swa.pt
2025-11-29 05:29:03.680 INFO: Epoch 78: head: Default, loss=0.10811906, MAE_E_per_atom=   11.79 meV, MAE_F=None meV / A
2025-11-29 05:42:18.895 INFO: Epoch 79: head: Default, loss=0.10781314, MAE_E_per_atom=   11.73 meV, MAE_F=None meV / A
2025-11-29 05:55:32.416 INFO: Epoch 80: head: Default, loss=0.10781022, MAE_E_per_atom=   11.79 meV, MAE_F=None meV / A
2025-11-29 06:08:47.112 INFO: Epoch 81: head: Default, loss=0.10818451, MAE_E_per_atom=   11.82 meV, MAE_F=None meV / A
2025-11-29 06:22:03.578 INFO: Epoch 82: head: Default, loss=0.10792537, MAE_E_per_atom=   11.74 meV, MAE_F=None meV / A
2025-11-29 06:35:18.601 INFO: Epoch 83: head: Default, loss=0.10751112, MAE_E_per_atom=   11.72 meV, MAE_F=None meV / A
2025-11-29 06:48:32.011 INFO: Epoch 84: head: Default, loss=0.10804669, MAE_E_per_atom=   11.68 meV, MAE_F=None meV / A
2025-11-29 07:01:47.382 INFO: Epoch 85: head: Default, loss=0.10818018, MAE_E_per_atom=   11.73 meV, MAE_F=None meV / A
2025-11-29 07:15:02.972 INFO: Epoch 86: head: Default, loss=0.10810309, MAE_E_per_atom=   11.70 meV, MAE_F=None meV / A
2025-11-29 07:28:15.433 INFO: Epoch 87: head: Default, loss=0.10764591, MAE_E_per_atom=   11.67 meV, MAE_F=None meV / A
2025-11-29 07:41:26.574 INFO: Epoch 88: head: Default, loss=0.10831416, MAE_E_per_atom=   11.73 meV, MAE_F=None meV / A
2025-11-29 07:54:38.896 INFO: Epoch 89: head: Default, loss=0.10786055, MAE_E_per_atom=   11.70 meV, MAE_F=None meV / A
2025-11-29 08:07:52.276 INFO: Epoch 90: head: Default, loss=0.10734028, MAE_E_per_atom=   11.69 meV, MAE_F=None meV / A
2025-11-29 08:21:07.515 INFO: Epoch 91: head: Default, loss=0.10746203, MAE_E_per_atom=   11.58 meV, MAE_F=None meV / A
2025-11-29 08:34:23.984 INFO: Epoch 92: head: Default, loss=0.10746966, MAE_E_per_atom=   11.65 meV, MAE_F=None meV / A
2025-11-29 08:47:37.056 INFO: Epoch 93: head: Default, loss=0.10809753, MAE_E_per_atom=   11.62 meV, MAE_F=None meV / A
2025-11-29 09:00:57.474 INFO: Epoch 94: head: Default, loss=0.10777851, MAE_E_per_atom=   11.64 meV, MAE_F=None meV / A
2025-11-29 09:14:16.698 INFO: Epoch 95: head: Default, loss=0.10791640, MAE_E_per_atom=   11.68 meV, MAE_F=None meV / A
2025-11-29 09:27:34.982 INFO: Epoch 96: head: Default, loss=0.10818468, MAE_E_per_atom=   11.70 meV, MAE_F=None meV / A
2025-11-29 09:40:56.770 INFO: Epoch 97: head: Default, loss=0.10747935, MAE_E_per_atom=   11.65 meV, MAE_F=None meV / A
2025-11-29 09:54:18.200 INFO: Epoch 98: head: Default, loss=0.10721981, MAE_E_per_atom=   11.57 meV, MAE_F=None meV / A
2025-11-29 10:07:34.125 INFO: Epoch 99: head: Default, loss=0.10710991, MAE_E_per_atom=   11.58 meV, MAE_F=None meV / A
2025-11-29 10:07:34.127 DEBUG: Deleting old checkpoint file: ./checkpoints/qmof_run-123_epoch-77_swa.pt
2025-11-29 10:07:34.136 DEBUG: Saving checkpoint: ./checkpoints/qmof_run-123_epoch-99_swa.pt
2025-11-29 10:07:34.188 INFO: Training complete
2025-11-29 10:07:34.188 INFO: 
2025-11-29 10:07:34.188 INFO: ===========RESULTS===========
2025-11-29 10:08:01.619 INFO: Loading checkpoint: ./checkpoints/qmof_run-123_epoch-47.pt
2025-11-29 10:08:01.678 INFO: Loaded Stage one model from epoch 47 for evaluation
2025-11-29 10:08:01.678 INFO: Saving model to checkpoints/qmof_run-123.model
2025-11-29 10:08:01.870 INFO: Compiling model, saving metadata to qmof_compiled.model
2025-11-29 10:08:02.593 INFO: Computing metrics for training, validation, and test sets
2025-11-29 10:08:02.594 INFO: Skipping evaluation for heads: ['pt_head']
2025-11-29 10:08:02.594 INFO: Evaluating train_Default ...
2025-11-29 10:14:14.775 INFO: Evaluating valid_Default ...
2025-11-29 10:15:12.053 INFO: Error-table on TRAIN and VALID:
+---------------+--------------------+-----------------+------------------+
|  config_type  | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+---------------+--------------------+-----------------+------------------+
| train_Default |           9.1      |       None      |       None       |
| valid_Default |          12.8      |       None      |       None       |
+---------------+--------------------+-----------------+------------------+
2025-11-29 10:15:12.053 INFO: Evaluating Default_Default ...
2025-11-29 10:19:42.268 INFO: Error-table on TEST:
+-----------------+--------------------+-----------------+------------------+
|   config_type   | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-----------------+--------------------+-----------------+------------------+
| Default_Default |          11.9      |       None      |       None       |
+-----------------+--------------------+-----------------+------------------+
2025-11-29 10:19:42.268 DEBUG: Running inference on train_Default dataset
2025-11-29 10:19:42.375 DEBUG: Plotting failed: too many indices for tensor of dimension 1
2025-11-29 10:19:42.375 INFO: Loading checkpoint: ./checkpoints/qmof_run-123_epoch-99_swa.pt
2025-11-29 10:19:42.451 INFO: Loaded Stage two model from epoch 99 for evaluation
2025-11-29 10:19:42.451 INFO: Saving model to checkpoints/qmof_run-123_stagetwo.model
2025-11-29 10:19:42.650 INFO: Compiling model, saving metadata qmof_stagetwo_compiled.model
2025-11-29 10:19:43.327 INFO: Computing metrics for training, validation, and test sets
2025-11-29 10:19:43.328 INFO: Skipping evaluation for heads: ['pt_head']
2025-11-29 10:19:43.328 INFO: Evaluating train_Default ...
2025-11-29 10:25:57.792 INFO: Evaluating valid_Default ...
2025-11-29 10:26:54.959 INFO: Error-table on TRAIN and VALID:
+---------------+--------------------+-----------------+------------------+
|  config_type  | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+---------------+--------------------+-----------------+------------------+
| train_Default |           6.2      |       None      |       None       |
| valid_Default |          11.6      |       None      |       None       |
+---------------+--------------------+-----------------+------------------+
2025-11-29 10:26:54.959 INFO: Evaluating Default_Default ...
2025-11-29 10:31:24.908 INFO: Error-table on TEST:
+-----------------+--------------------+-----------------+------------------+
|   config_type   | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-----------------+--------------------+-----------------+------------------+
| Default_Default |          10.7      |       None      |       None       |
+-----------------+--------------------+-----------------+------------------+
2025-11-29 10:31:24.909 DEBUG: Running inference on train_Default dataset
2025-11-29 10:31:25.041 DEBUG: Plotting failed: too many indices for tensor of dimension 1
2025-11-29 10:31:25.041 INFO: Done
